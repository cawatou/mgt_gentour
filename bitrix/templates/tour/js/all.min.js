


function preloadOff(){
	var t = $("#page-preloader"),
	e = t.find(".spinner");
	e.fadeOut(), t.delay(350).hide()
}
function renderEmloeyrs(city, tvcity){
	if(!city && !tvcity){
		city = 95;
		tvcity = 1;
	}
	$.ajax({
		url: '/ajax/renderemloyers.php?city='+city+'&tvcity='+tvcity,
		type: 'POST',
		success: function(data){

			var items = 3




			var h1 = $('section#ourpeople h1').clone()
			$('section#ourpeople .fp-tablecell').html(data).prepend(h1)

			if($.trim($('.addme').html()) == '') {
				$('.magic').remove()
				items = 4
				$('.workers').closest('.col-md-10').css({
					'width': '100%'
				})
			}

			if($('.addme p').text().length > 280) {
				$('.addme p').text($('.addme p').text().substr(0, 280) + '...')
			}

			if($(window).width() < 500) {
				var addMeClone = $('.addme').clone()
				$('.addme').hide()
				addMeClone.appendTo('.workers')
			}
			if($(window).width() > 1000 || $(window).width() < 620) {
				$('.workers').owlCarousel({
					loop:true,
					autoplay: true,
					autoplayTimeout: 3000,
					margin:20,
					dots:false,
					responsive:{
						0:{
							items:1,
							nav:true
						},
						600:{
							items:1,
							nav:true
						},
						768: {
							items: 2,
							nav:true
						},
						1000:{
							items:items,
							nav:false
						}
					}
				});

			}




			if($(window).width() < 1000 && $(window).width() > 620) {
				$('.magic').appendTo('.ourpeoples .col-md-10 .workers')
			}

			if($(window).width() > 1000) {
				if($('.workers .item').length > 0) {
					var w = $('.workers .item').eq(0).width() - 60
					
					$('.addme').width(w)	
					$(window).resize(function(){
						$('.addme').width(w)
					})
				}
				
			}
			return true
		}
	})



}



function inWindow(s){
	var scrollTop = $(window).scrollTop();
	var windowHeight = document.body.clientHeight;
	var currentEls = $(s);
	var result = [];
	currentEls.each(function(){
		var el = $(this);
		var offset = el.offset();
		if(scrollTop <= offset.top && (el.height() + offset.top) < (scrollTop + windowHeight))
			result.push(this);
	});
	return $(result);
}



if($('#fullPage').length > 0){
	var poputchikiGlobalArr = new Array();
	$('.poputki .companions').each(function(){
		var id = $(this).data('id')
		poputchikiGlobalArr[id] = 'true'
	})

	function addViewCountForCompanion(id){
		if(poputchikiGlobalArr[id] == 'true'){
			$.ajax({
				url: "/ajax/viewscompanioncontroller.php",
				type: "POST",
				data: {
					"id_review" : id
				},
				success: function(e) {
					poputchikiGlobalArr[id] = 'false'
					//console.log(poputchikiGlobalArr)
				}
			})
		}
	}
}

else if($('.poputchiki-block-wrap').length > 0) {
	var poputchikiGlobalArr = new Array();
	$('.find-box').each(function(){
		var id = $(this).data('id')
		poputchikiGlobalArr[id] = 'true'
	})

	function addViewCountForCompanion(id){
		//console.log(id)
		if(poputchikiGlobalArr[id] == 'true'){
			$.ajax({
				url: "/ajax/viewscompanioncontroller.php",
				type: "POST",
				data: {
					"id_review" : id
				},
				success: function(e) {
					poputchikiGlobalArr[id] = 'false'
					//console.log(poputchikiGlobalArr)
				}
			})
		}
	}
}

function dosearchOrders(el) {
	term = $(".text-searcher-order").val();


  jQuery('span.highlight').each(function(){ //удаляем старую подсветку
  	jQuery(this).after(jQuery(this).html()).remove();  
  });


  var t = '';
  el.each(function(){ // в селекторе задаем область поиска
   jQuery(this).html(jQuery(this).html().replace(new RegExp(term, 'ig'), '<span class="highlight">$&</span>')); // выделяем найденные фрагменты

   if($(this).closest('tr').find('span.highlight').length == 0){
   	
   	$(this).closest('tr').hide()

   	$(this).closest('tr').prev().hide()


   }

   



   n = jQuery('span.highlight').length; // количество найденных фрагментов
  // console.log('n = '+n);
   // if (n==0)
   //  jQuery('.searchedElems').html('Ничего не найдено').addClass('nothing').removeClass('something');
   // else
   //  jQuery('.searchedElems').html('Результатов: '+n).addClass('something').removeClass('nothing'); 
});

// .filter(':visible')

//   $('.highlight').each(function(i){
//   	$(this).attr('id', 's'+i)
//   })
}



function orderFilter(){
	if($("select[name=filtrzayavka]").val() == '0'){
		var typeValue = ''
	}
	else {
		var typeValue = '.' + $("select[name=filtrzayavka]").val()
	}
	
	var textValue = $.trim($(".text-searcher-order").val())
	var townValue = $("select[name=filtrtown]").val()
	var officeValue = $("select[name=filtroffice]").val()



	if(typeValue == '0' &&
		typeValue == '' &&
		townValue == 'all' &&
		officeValue == 'all' ) {


		$("#orders tbody tr").show()

	$('.separatortenpx').show()

}
else {


	$("#orders tbody tr.showmeall")
		.hide()
		.prev()
		.hide()

	$('.separatortenpx').hide()


	$("#orders tbody tr" + typeValue).each(function(){
		if(($(this).data('city') == townValue || townValue == 'all' || $(this).data('city') == "") &&
			($(this).data('office') == officeValue || officeValue == 'all' || $(this).data('office') == "") ) {

			$(this).show().prev('tr').show().prev('.separatortenpx').show()

	}
})

	dosearchOrders($('#orders tbody .separatortenpx').next().find('td'))




}









}




function renderFormFunction(){



	$('.select-office').unbind('change')
	$('.footer_link a[qdata-target="#orderfor"]').unbind('click')
	$('#orderfor').unbind('shown.bs.modal')





	$('input[name="form_text_88"]').closest('.form-group').hide()
	$.ajax({
		url: '/ajax/chooseoffice.php',
		success: function(data){
			$('select').styler('destroy')
			$('input[name="form_text_88"]').closest('.form-group').after(data)
			$('input[name="form_text_88"]').val($('#orderfor .first-chosen-id').data('id'))

			$('input[name="form_hidden_107"]').closest('.form-group').after(data)
			$('input[name="form_hidden_107"]').val($('#callback .first-chosen-id').data('id'))

			$('input[name="form_hidden_115"]').closest('.form-group').after(data)
			$('input[name="form_hidden_115"]').val($('#question .first-chosen-id').data('id'))
			initDropdown()
		}
	})



	$('#orderfor .select-office').bind('change', function(){
		$('input[name="form_text_88"]').val($(this).val())
	})

	$('#callback .select-office').bind('change', function(){
		$('input[name="form_text_88"]').val($(this).val())
	})

	//$('input[name="form_text_88"]').val($('#orderfor .select-office option').eq(0).attr('value'))
	


	$('.footer_link a[data-target="#orderfor"]').bind('click', function(){
		$('#orderfor input[name="form_hidden_101"]').val('podbor')
	})


	$('#orderfor').bind('shown.bs.modal', function () {
		$('input[name="form_hidden_102"]').val($('.letterlist a.active').eq(0).text())
	})

	$('[name="form_text_91"], [name="form_textarea_92"], [name="form_hidden_93"], [name="form_hidden_92"], input[name="form_checkbox_payment_type[]"]').each(function(){
		$(this).closest('.form-group').hide()
	})









	if(registeredOne) {
		$('#question input[name="form_email_26"]')
		.attr('value', registeredEmail)
		.closest('.form-group')
		.addClass('has-success')
	}



}



renderFormFunction()




function sortMsges(){

	$('.msglines').sort(function(a,b){
		return parseInt(a.id) < parseInt(b.id);
	}).each(function () {
		var elem = $(this);
		elem.remove();
		$(elem).appendTo(".msg");
	});

}

sortMsges()

function workingWithOrders(ordercode){
	var o = ordercode

	$(document).on("change", ".changeStatus."+ordercode+"", function(t) {
		t.preventDefault();

		if(ordercode != 'sale' && ordercode != 'podbor') {
			var stat =  $(this).val()+'else'
		}
		else {
			var stat = $(this).val()
		}
		var e = $(this).closest("tr").data("orderid"),
		a = $(this).val();
		"" != e && "" != a && $.get("/ajax/order.php", {
			id: e,
			action: "changestat"+ordercode,
			stat: stat
		}, function(t) {
			"" !== t && alert(t)
		})
	})




	$(document).on("click", ".save-comment."+ordercode+"", function(t) {
		txt = $(this).prev().find("textarea").val(), id = $(this).closest("tr").data("orderid"), "" != id && "" != txt && $.get("/ajax/order.php", {
			id: id,
			action: "updatecomm"+ordercode,
			txt: txt
		}, function(t) {
			"" !== t && alert(t)
		}), $(this).prev().html(txt), $(this).append('<img src="/bitrix/templates/tour/images/paladdin/edit.png" />'), $(this).removeClass("save-comment"), $(this).addClass("edit-comment")
	}) 

}

var sPage = 1



$(".daterangepickerpal").daterangepicker({
	locale: {
		format: "DD.MM",
		separator: " - ",
		applyLabel: "Выбрать",
		cancelLabel: "Отмена",
		fromLabel: "от",
		toLabel: "до",
		keepEmptyValues: true,
		customRangeLabel: "Custom",
		weekLabel: "W",
		daysOfWeek: ["Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб"],
		monthNames: ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"],
		firstDay: 1
	}
})


setTimeout(function(){
	$(window).scroll(function(){
		var boxesinwindow = inWindow('.find-box')
		//console.log(boxesinwindow)
		
		boxesinwindow.each(function(){
			var id = $(this).data('id')
			//console.log(id)
			addViewCountForCompanion(id)
		})
	})
}, 2000)




isMobile = {
	Android: function() {
		return navigator.userAgent.match(/Android/i);
	},
	BlackBerry: function() {
		return navigator.userAgent.match(/BlackBerry/i);
	},
	iOS: function() {
		return navigator.userAgent.match(/iPhone|iPad|iPod/i);
	},
	Opera: function() {
		return navigator.userAgent.match(/Opera Mini/i);
	},
	Windows: function() {
		return navigator.userAgent.match(/IEMobile/i);
	},
	any: function() {
		return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
	}
};

function  showCaseBind() {

	$('.showcase_tours .hotdeals div, .remaining_tours .hotdeals div').bind('click', function(){
		var url = $(this).closest('.hotdeals').attr('data-url');
		window.location = url
	});
	// Переход в для соседнего города
	$('.sibling_tours .hotdeals div').bind('click', function(){
		var id = $(this).closest('.hotdeals').attr('data-id');
		console.log(id);
		id = $('.letterlist a[data-citytv="'+id+'"]').data('city')
		console.log(id);
		$.ajax({
			type: 'post',
			url: '/ajax/city.php',
			data: {
				"city": id
			},
			success: function(data){
				//console.log(data);
				location.reload()
			}

		})
	});
}
var scrollelem = '';
function initDropdown() {
	if (!isMobile.any()) {
		$('select').each(function(){
			$(this).styler({
				locale: 'ru',
				locales: {
					'ru': {
						selectPlaceholder: '',
					}
				},
				selectSmartPositioning: true,
				onFormStyled: function(){
					_dropdown = $('.jq-selectbox__dropdown');
					//_dropdown.find('ul').wrap('<div class="scroll-pane" />');

					$('.quest textarea').val('')

					
					var fulltableTr = $('.fulltable').closest('tr');
					var headTr = $('.fulltr').closest('tr');
					headTr.each(function(){
						if($(this).prev('.separatortenpx').length == 0) {
							$(this).before('<div class="separatortenpx"></div>')
						}
						$(this)
						.find('td')
						.css({
							'border-radius': '6px 6px 0 0'
						})
					})
					fulltableTr.each(function(){
						$(this)
						.find('td')
						.css({
							'border-radius': '0 0 6px 6px',
							'overflow': 'hidden'
						})
					})

					$('#orders .showmeall td:first-child').each(function(){
						$(this)
						.css({
							'border-radius': '0 0 0 6px'
						})
						.click(function(){
							var thisEl = $(this)
							$('#orders .showmeall td').css({
								'border-radius': '0 0 0 6px'
							})
							thisEl.closest('tr').find('td').css({
								'border-radius': '0'
							})
						})
					})
					$('#orders .showmeall td:last-child').each(function(){
						$(this)
						.css({
							'border-radius': '0 0 6px 0'
						})
						.click(function(){
							var thisEl = $(this)
							$('#orders .showmeall td').css({
								'border-radius': '0 0 6px 0'
							})
							thisEl.closest('tr').find('td').css({
								'border-radius': '0'
							})
						})
					})






					$('.changeStatus').each(function(){
						if($(this).next('.jq-selectbox__select').find('img').length == 0){
							var value = $(this).next('.jq-selectbox__select').find('.jq-selectbox__select-text').text()
							var statusImg = '';

							switch(value) {
								case ' Новая заявка':
								statusImg = 'new-one.png'
								break;
								case 'Обработано':
								statusImg = 'tick.png'
								break;
								default:
								statusImg = 'proccess.png'
								break;

							}


							$(this).next('.jq-selectbox__select').prepend('<img src="/bitrix/templates/tour/images/paladdin/'+statusImg+'" alt="" />')
						}
					})

					// $('.sale .fulltable p, .officeorder .fulltable p').each(function(){
					// 	var index = $(this).text().search(':')
					// 	var text = $(this).text()
					// 	console.log(text)

					// 	var textSubOne = text.substr(0, index-1)
					// 	var textSubTwo = text.substr(index, text.length)

					// 	textSubOne = '<b>'+textSubOne+'</b>'

					// 	$(this).html(textSubOne + textSubTwo)
					// })

				},
				onSelectOpened: function(){
					if($(this).find('.scroll-pane').length == 0) {
						$(this).find('ul').wrap('<div class="scroll-pane" />');
					}
					else {

					}

					var _ul = $(this).find('.jq-selectbox__dropdown ul');
					var height = _ul.height();
					if(height > 150) {
						height = '150px'
					}


					//alert(height)
					var _srollPane = $(this).find('.scroll-pane');
					var container = _srollPane.find('.jspContainer')

					_srollPane.css('height', height);
					scrollelem = _srollPane.jScrollPane({
						autoReinitialise: true
					});
				}


			})
		})
	}
}



if($(window).width() <= 1000) {
	$('#articles').after('<section id="poputka-mobile" style="background: url(/bitrix/templates/tour/images/slide12.jpg) no-repeat;"></section>')
	$('#poputka-mobile')
	.css({
		'height': $(window).height()
	})
	.addClass('vertical-scrolling fp-section fp-table')
	$('#poputka-mobile').append('<div class="fp-tablecell" style="max-height:'+ $(window).height()+';"></div>')

	$('#poputka-mobile .fp-tablecell').append($('.poputchiki-container'))
	
}

function zoomForDeskTops() {
	if($(window).width() > 1000) {

		var mainpagecoeffHeight = 930

		var  mainpagecoeff = 1/parseFloat(mainpagecoeffHeight.toFixed(3))

		var windowHeight = document.body.clientHeight

		var currentZoomCoef = mainpagecoeff * windowHeight

		currentZoomCoef = parseFloat(currentZoomCoef.toFixed(3))

		return currentZoomCoef

	}
	else {
		return 1;
	}
}

function get_name_browser(){
	var ua = navigator.userAgent;    
	if (ua.search(/Chrome/) > 0) return 'Google Chrome';
	if (ua.search(/Firefox/) > 0) return 'Firefox';
	if (ua.search(/Opera/) > 0) return 'Opera';
	if (ua.search(/Safari/) > 0) return 'Safari';
	if (ua.search(/NET/) > 0) return 'IE';

}


function zoomFp() {
	if(get_name_browser() == 'Firefox' || get_name_browser() == 'IE' || $(window).width() == 1024) {
		$('.fp-tableCell').not('#fullPage section:first-child .fp-tableCell').css({
			'transform-origin': 'center 202px'
		})
		$(window).resize(function(){
			$('.fp-tableCell').not('#fullPage section:first-child .fp-tableCell').css({
				'transform-origin': 'center 202px'
			})
			$('.bx-yandex-view-layout').closest('.fp-tableCell').css({
				'transform': 'none'
			})
		})


		$('.bx-yandex-view-layout').closest('.fp-tableCell').css({
			'transform': 'none'
		})



		$('.fp-tableCell').not($('.bx-yandex-view-layout').closest('.fp-tableCell')).css({
			'-webkit-transform': 'scale('+zoomForDeskTops()+')',
			'transform': 'scale('+zoomForDeskTops()+')',
			'transform-origin': 'center' 
		});
		$('.daterangepicker, .ui-widget.ui-widget-content').css({
			'-webkit-transform': 'scale('+zoomForDeskTops()+')',
			'transform': 'scale('+zoomForDeskTops()+')',
			'transform-origin': 'center' 
		});
	}
	else {


		$('.fp-tableCell, .navigation').not($('.bx-yandex-view-layout').closest('.fp-tableCell')).css({
			'-webkit-zoom': zoomForDeskTops(),
			'zoom': zoomForDeskTops(),
		});
		$('.bx-yandex-view-layout').closest('.fp-tableCell').css({
			'padding-bottom': '0px'
		})
		$('.ymaps-map ymaps-i-ua_js_yes').width($(window).width())
		$('.daterangepicker, .ui-widget.ui-widget-content').css({
			'-webkit-zoom': zoomForDeskTops(),
			'zoom': zoomForDeskTops(),
		});


	}
}


function fp() {
	$('#fullPage').addClass('jobsdone')
	$("#fullPage").fullpage({
		sectionSelector: ".vertical-scrolling",
		slideSelector: ".slideTur",
		controlArrows: !0,
		lazyLoading: !0,
		scrollHorizontally: !0,
		interlockedSlides: !0,
		continuousHorizontal: !0,
		normalScrollElements: ".cityAll2, .navigation, .modal, .hot-carusel2",
		resetSliders: true,
		dragAndMove: !0,
		responsiveSlides: !0,
		easing: "easeInOutCubic",
		fixedElements: ".footer, .navbar",
		afterLoad: function(t, e) {},
		afterRender: function() {
			zoomFp()
			preloadOff();


			// var sec1 = $('section').eq(0).find('.fp-tableCell')
			// sec1.find('.tourmain').css('animation-delay', '0.5s');
			// sec1.find('.tourmain').addClass('animated fadeInDown');
			// sec1.find('#startsearch').css('animation-delay', '1.4s');
			// sec1.find('#startsearch').addClass('animated zoomIn');
			// sec1.find('.hotindex').css({
			// 	'opacity': '0',
			// 	'animation-delay': '1s',
			// 	'transition': '.5s'
			// });

			// $('.fp-tableCell').css({
			// 	'max-height': $(window).height(),
			// 	'height': 'auto'
			// })

			// setTimeout(function(){
			// 	sec1.find('.hotindex').css('opacity', '1').addClass('animated slideInUp');
			// }, 1500)

		},
		onLeave: function(t, e, a) {
			zoomFp()
			$(this);

	// alert($('#fullpage>section').eq(2).find('.poputki').length)
	// alert((e-1))

	if($('#fullpage>section').eq(e-1).find('.poputki').length > 0 &&($(window).width() > 1000 || $(window).width() < 620)) {
		

		var id = $('.poputki .owl-item.active .companions').data('id')
		addViewCountForCompanion(id)


	}

	else if($('#fullpage>section').eq(e-1).find('.poputki').length > 0 && $(window).width() < 1000 && $(window).width() > 620) {
		var cicicicicicicici = 0
		$('.poputki .companions').each(function(){
			if(cicicicicicicici < 4){
				var id = $(this).data('id')
				addViewCountForCompanion(id)
				cicicicicicicici++
			}
		})
	}	
	if($(window).width() <= 992) {
		

		var mobileMenuCoefficient = 11;

		if($('#fullpage>section').length == 11) {
			var mobileMenuCoefficient = 10;
		}

		if(mobileMenuCoefficient == e) {
			$(".navbar").addClass("bgblack");
		}
		else {
			$(".navbar").removeClass("bgblack")
		}


	}



	if($(window).width() < 621) {
		if(2 < t && "up" == a && t != 2) {
			$("#scroller").fadeIn()
			$("#scroller").removeClass('hiddenscroller')
			$(document).bind('click', function(event) {
				if ($(event.target).closest("#scroller").length) return;
				$("#scroller").fadeOut();
				event.stopPropagation();
				$(document).unbind('click')
			});
		}
		if(t == 2) {
			$("#scroller").fadeOut()
		}
		$("#scroller").click(function(){
			$("#scroller").addClass('hiddenscroller')
		})

	}
	else {
		if(1 == t && "down" == a) {
			$("#scroller").fadeIn()
		}
		else if(2 == t && "up" == a) {
			$("#scroller").fadeOut()
		}
	}
	

	// if($(window).width() >= 992) {



	// 	if(3 == t && "down" == a) {

	// 		$('.socials-block .soc:nth-child(1)').css("animation-delay", "0.7s")
	// 		$('.socials-block .soc:nth-child(2)').css("animation-delay", "1s")
	// 		$('.socials-block .soc:nth-child(3)').css("animation-delay", "1.3s")
	// 		$('.socials-block .soc:nth-child(4)').css("animation-delay", "1.5s")

	// 		$('.socials-block .soc').addClass("animated flipInY")


	// 	}


	// 	if (1 == t && "down" == a && $("#scroller").fadeIn(), 2 == t && "up" == a && $("#scroller").fadeOut(), 1 == t) {
	// 		var o = $("section").eq(t).find(".fp-tableCell");
	// 		o.find(".hottur").css("animation-delay", "0.7s"), o.find(".hottur").addClass("animated zoomInDown"), o.find(".hotturblock").css("animation-delay", "2s"), o.find(".hotturblock").addClass("animated zoomIn"), $(".fp-next, .fp-prev").css({
	// 			opacity: 0
	// 		}), $(".fp-next, .fp-prev").delay(2500).animate({
	// 			opacity: 1
	// 		})
	// 	}

	// 	if (2 == t)
	// 		if (8 == $("#fullPage>section").length) {
	// 			var o = $("section").eq(t).find(".fp-tableCell");
	// 			o.find(".socials-block .soc").eq(0).add(o.find(".socials-block .soc").eq(3)).css("animation-delay", "1.8s").addClass("animated bounceIn"), o.find(".socials-block .soc").eq(1).add(o.find(".socials-block .soc").eq(2)).css("animation-delay", "1.5s").addClass("animated bounceIn"), o.find(".we-are-in-socials").css("animation-delay", ".6s").addClass("animated rollIn")
	// 		} else {
	// 			var o = $("section").eq(2).find(".fp-tableCell");
	// 			o.find(".hottur").css("animation-delay", "0.7s"), o.find(".hottur").addClass("animated flipInY"), o.find(".hotturblock").css("animation-delay", "2s"), o.find(".hotturblock").addClass("animated zoomIn")
	// 		}
	// 		if (3 == t) 
	// 			if (8 == $("#fullPage>section").length) {
	// 				var o = $("section").eq(t).find(".fp-tableCell");
	// 				o.find(".reviews").css("animation-delay", "1.3s"), o.find(".reviews").addClass("animated slideInUp"), o.find(".articles").css("animation-delay", "0.7s"), o.find(".articles").addClass("animated slideInUp"), o.find(".reviews").css("animation-delay", "1.3s"), o.find(".poputchiki-container").addClass("animated slideInUp"),  o.find(".poputchiki-container").css("animation-delay", "0.7s")
	// 			} else {
	// 				var o = $("section").eq(t).find(".fp-tableCell");

	// 				o.find(".poputki .owl-item.active .item").eq(0).css("animation-delay", "1.5s"), o.find(".poputki .owl-item.active .item").eq(1).css("animation-delay", "1.8s"), o.find(".poputki .owl-item.active .item").eq(2).css("animation-delay", "2.1s"), o.find(".poputki .owl-item.active .item").addClass("animated flipInY"), o.find(".poputchik").css("animation-delay", ".6s"), o.find(".poputchik").addClass("animated rollIn"), o.find(".btnusers").css("animation-delay", "2.6s"), o.find(".btnusers").addClass("animated zoomInDown")
	// 			}
	// 			if (4 == t)
	// 				if (8 == $("#fullPage>section").length) {
	// 					var o = $("section").eq(t).find(".fp-tableCell");
	// 					o.find(".pc-ver").css("animation-delay", "0.7s"), o.find(".pc-ver").addClass("animated rotateInDownLeft"), o.find(".mobile-section").css("animation-delay", "0.7s"), o.find(".mobile-section").addClass("animated rotateInUpRight")
	// 				} else {
	// 					var o = $("section").eq(t).find(".fp-tableCell");
	// 					o.find(".reviews").css("animation-delay", "0.7s"), o.find(".reviews").addClass("animated slideInUp"), o.find(".articles").css("animation-delay", "1s"), o.find(".articles").addClass("animated slideInUp"), o.find(".poputchiki-container").addClass("animated slideInUp"),  o.find(".poputchiki-container").css("animation-delay", "0.7s")
	// 				}
	// 				if (5 == t && 6 == e)
	// 					if (8 == $("#fullPage>section").length) {
	// 						var o = $("section").eq(t).find(".fp-tableCell");
	// 						o.find(".reviewlink, .workers .owl-item.active .item , .addme, .ourpeople").css("opacity", "0"), o.find(".reviewlink").delay(2100).animate({
	// 							opacity: 1
	// 						}), o.find(".workers .owl-item.active .item").eq(0).delay(900).animate({
	// 							opacity: 1
	// 						}), o.find(".workers .owl-item.active .item").eq(1).delay(1200).animate({
	// 							opacity: 1
	// 						}), o.find(".workers .owl-item.active .item").eq(2).delay(1500).animate({
	// 							opacity: 1
	// 						}), o.find(".addme").delay(1800).animate({
	// 							opacity: 1
	// 						}), o.find(".ourpeople").delay(600).animate({
	// 							opacity: 1
	// 						})
	// 					} else {
	// 						var o = $("section").eq(t).find(".fp-tableCell");
	// 						o.find(".pc-ver").css("animation-delay", "0.7s"), o.find(".pc-ver").addClass("animated rotateInDownLeft"), o.find(".mobile-section").css("animation-delay", "0.7s"), o.find(".mobile-section").addClass("animated rotateInUpRight")
	// 					}
	if (6 == t && 7 == e)
		if (8 == $("#fullPage>section").length) $(".navbar").addClass("bgblack");
	else {

		var o = $("section").eq(t).find(".fp-tableCell");
	 						// o.find(".reviewlink, .workers .owl-item.active .item , .addme, .ourpeople").css("opacity", "0"), o.find(".reviewlink").delay(2100).animate({
	 						// 	opacity: 1
	 						// }), o.find(".workers .owl-item.active .item").eq(0).delay(900).animate({
	 						// 	opacity: 1
	 						// }), o.find(".workers .owl-item.active .item").eq(1).delay(1200).animate({
	 						// 	opacity: 1
	 						// }), o.find(".workers .owl-item.active .item").eq(2).delay(1500).animate({
	 						// 	opacity: 1
	 						// }), o.find(".addme").delay(1800).animate({
	 						// 	opacity: 1
	 						// }), o.find(".ourpeople").delay(600).animate({
	 						// 	opacity: 1
	 						// }), 

	 						$(".navbar").removeClass("bgblack")
	 					}
	 					7 == t && 8 == e && (8 == $("#fullPage>section").length ? $(".navbar").removeClass("bgblack") : $(".navbar").addClass("bgblack")), (8 == t || 7 == t) && (8 == $("#fullPage>section").length ? (8 == e || 6 == e) && $(".navbar").removeClass("bgblack") : (9 == e || 7 == e) && $(".navbar").removeClass("bgblack")), (9 == t || 8 == t) && (8 == $("#fullPage>section").length ? 7 == e && $(".navbar").addClass("bgblack") : 8 == e && $(".navbar").addClass("bgblack"))
	// 				}
}
})




}
function getForm(t, e, formEl) {
	$.ajax({
		url: "/ajax/form.php?id=" + t,
		type: "POST",
		data: e,
		success: function(e) {

			var modal = formEl.closest('.modal')

			modal.modal("hide")

			

			if(e.search('input') ==  -1){

				if(t == 3) {
					var html = '<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>Спасибо!</h1><p>Мы скоро вам перезвоним</p></div>'
					e = html
				}
				if(t == 6) {
					var html = '<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>Спасибо!</h1><p>Мы перзвоним вам в течение 3х дней</p></div>'
					e = html
				}
				if(t == 9) {
					var html = '<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>Ваша подписка на рассылку оформлена!</h1><p></p></div>'
					e = html
				}

				if(t == 5) {
					var html = '<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>Заявка принята в обработку</h1><p>С вами связжется менеджер по туризму вашего города</p></div>'
					e = html
				}

				$("#answer .modal-content").html(e);

				var a = $("#answer .modal-content form tbody tr:last-child td:first-child").html(),

				o = $("#answer .modal-content form tbody tr:last-child td:last-child").html();

				$("#answer .modal-content form tbody tr:last-child td:last-child").html(a), 

				$("#answer .modal-content form tbody tr:last-child td:first-child").html(o), 

				Recaptchafree.reset(), 

				$("#answer .modal-content form tbody tr").each(function() {
					"" == $(this).find("td").eq(0).text() && $(this).remove()
				}), $('#answer .modal-content form input[type="submit"]').addClass("btnformmodalred"), 

				$(".data-table tr td:first-child").hide(), 

			//2 == t && $("#answer .modal-content").prepend('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button><h4 class="modal-title" id="myModalLabel">Задать вопрос</h4></div>'), 

			$("#answer").modal("show")

			formEl[0].reset()
			formEl.find('*').removeClass('has-success')
			formEl.find('.glyphicon-ok').remove()

			Recaptchafree.reset()
		}
		else {
			
			setTimeout(function(){

				modal.find('.modal-content').html(e)
				renderFormFunction()
				Recaptchafree.reset()
				modal.modal("show")
			}, 1500)




		}



	}
}), Recaptchafree.reset()

	$('select').trigger('refresh')

	Recaptchafree.reset()
}

function getCurort() {
	cntr = "", $('select[name="countryz"]').val() && (cntr = "&regcountry=" + $('select[name="countryz"] :selected').data("cid")), $.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=region" + cntr + "&callback=?", function(t) {
		for (var e = '<option value="0">выберите курорт</option>', a = 0; a < t.lists.regions.region.length; a++) t.lists.regions.region[a].name == $('select[name="curort"]').data("editid") ? sel = "selected" : sel = "", e = e + '<option value="' + t.lists.regions.region[a].name + '" ' + sel + ' data-kid="' + t.lists.regions.region[a].id + '">' + t.lists.regions.region[a].name + "</option>";
			$('select[name="curort"]').html(e)
	}), refresher()
}

function getCountry() {

	cid = $('select[name="cityID"]').val(), $.getJSON("http://tourvisor.ru/xml/list.php?format=json&cndep=" + cid + "&type=country&callback=?", function(t) {

		if(t.lists.countries.country){for (var e = "<option value='0'>Выберите страну</option>", a = 0; a < t.lists.countries.country.length; a++) e = e + "<OPTION value='" + t.lists.countries.country[a].id + "'>" + t.lists.countries.country[a].name + "</option>"};


		$('select[name="countryID"]').html(e)

		if($('select[name="countryID"]').data("city")) {
			$('select[name="countryID"]').find('option[value="'+$('select[name="countryID"]').data("city")+'"]').attr('selected', 'selected')
		}

		// if()
	}), refresher()

	
}

function getCountryz() {
	cid = $('select[name="cityz"] :selected').data("tvid"), void 0 !== cid && $("input[name=tvid]").val(cid), $.getJSON("http://tourvisor.ru/xml/list.php?format=json&cndep=" + cid + "&type=country&callback=?", function(t) {
		for (var e = "<option value='0'>Выберите страну</option>", a = 0; a < t.lists.countries.country.length; a++) t.lists.countries.country[a].name == $('select[name="countryz"]').data("editid") ? sel = "selected" : sel = "", e = e + "<OPTION value='" + t.lists.countries.country[a].name + "' data-cid='" + t.lists.countries.country[a].id + "' " + sel + ">" + t.lists.countries.country[a].name + "</option>";
			$('select[name="countryz"]').html(e)
	}), refresher()
}

function getPic() {
	ob = $(".sliderhotel .hotel.nobgr:eq(0)"), txt = ob.data("hid"), void 0 !== txt && $.get("/ajax/getinfo.php", {
		a: "pic",
		id: txt
	}, function(t) {
		"" != t ? ob.css("background-image", "url(" + t + ")") : ob.css("background-image", "url(/bitrix/templates/tour/images/bgrtour_03.png)"), ob.removeClass("nobgr"), setTimeout(function() {
			getPic()
		}, 500)
	}), inProgress = "none" == ob.parent().css("display") ? !1 : !0
}

function refresher() {
	setTimeout(function() {
		$("select").trigger("refresh")
	}, 1e3)
}

function hotelsReload() {
	if (0 != $('select[name="countryID"]').val()) {
		var t = "",
		e = "",
		a = "";
		$('input[name="curort[]"]:checked').each(function() {
			a = $(this).val() + ","
		}), $('input[name="type[]"]:checked').each(function() {
			"active" == $(this).val() && (e += "&hotactive=1"), "relax" == $(this).val() && (e += "&hotrelax=1"), "family" == $(this).val() && (e += "&hotfamily=1"), "health" == $(this).val() && (e += "&hothealth=1"), "city" == $(this).val() && (e += "&hotcity=1"), "beach" == $(this).val() && (e += "&hotbeach=1"), "deluxe" == $(this).val() && (e += "&hotdeluxe=1")
		});
		var o = "",
		n = "";
		"" != $('select[name="countryID"]').val() && (t = "&hotcountry=" + $('select[name="countryID"]').val()), "" != $('select[name="raiting"]').val() && (n = "&hotrating=" + $('select[name="raiting"]').val()), void 0 !== $('input[name="hotelstar"]:checked').val() && (o = "&hotstars=" + $('input[name="hotelstar"]:checked').val()), a.length > 0 && (a = a.slice(0, -1), a = "&hotregion=" + a), $.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=hotel" + t + a + e + o + n + "&callback=?", function(t) {
			var e = "";
			if(typeof t.lists != 'undefined')
				if (t.lists.hotels.hotel.length > 0) 
					for (var a = 0; a < t.lists.hotels.hotel.length; a++) e = e + '<li><span class="checkme"></span><input type="checkbox" name="hotel[]" value="' + t.lists.hotels.hotel[a].id + '" class="hidecheck"> <label class="checkb">' + t.lists.hotels.hotel[a].name + " " + t.lists.hotels.hotel[a].stars + "*</label></li>";
						$(".hotelscheck").html(e)

				})

		
	}
}

function foundHotel() {
	var t = $(".letter a.act").data("index"),
	e = $('select[name="srch_kur_name"]').val(),
	a = $('select[name="srch_cat_name"]').val();
	$(".hotel").each(function(o) {
		a1 = !0, a2 = !0, a3 = !0;
		var n = $(this).data("firstletter"),
		i = $(this).data("type"),
		s = $(this).data("regions");
		void 0 !== t && (t == n ? a1 = !0 : a1 = !1), "" !== e && (e == s ? a2 = !0 : a2 = !1), "" !== a && (i.indexOf(a, 0) > 0 ? a3 = !0 : a3 = !1), a1 && a2 && a3 ? $(this).parent().css("display", "block") : $(this).parent().css("display", "none")
	}), $grid.masonry("layout")
}

function searchrow() {
	var t = $('input[name="filter_city"]').val(),
	e = $('input[name="filter_country"]').val();
	$(".table-striped tbody tr td:nth-child(2)").each(function(a) {
		ob = $(this).closest("tr");
		var o = !1,
		n = !1;
		txt = $(this).text(), "" != t && (txt.indexOf(t) >= 0 && (o = !0), "" == e && (n = !0)), "" != e && (txt.indexOf(e) >= 0 && (n = !0), "" == t && (o = !0)), "" == e && "" == t && (o = !0, n = !0), o && n ? ob.show() : ob.hide()
	})
}

function hblkhvr() {

	$(".hotblocks").parent().hover(function() {
		$('.hotdeals div').unbind('click')
		setTimeout(function(){
			showCaseBind()
		}, 200)
		$(this).find(".hotdeals").addClass("active")
	}, function() {
		$(this).find(".hotdeals").removeClass("active")
		showCaseBind()
	})


}

function changesort() {
	$(".sorthotel").each(function(t) {
		$(this).val(t + 1), $(this).prev().html(t + 1)
	})
}

function replacer(t, e, a) {
	return t.indexOf("dates") >= 0 ? "dates[" + $(".hotBaseAndDate").length + "]" : void 0
}

function replacers(t, e, a) {
	return "promo[" + ($("#discounts input[type=checkbox]").length + 1) + "]"
}

function checkState(id,page){
	inProgress = true;
	$.get('/ajax/search.php',{id:id,page:page},function(data){
		if(data.error) {
			$("#answer .modal-content").html("Укажите дату вылета");

			$("#answer").modal('show');
		}
		
		if(!$('.search .founded .statuse').length) { 
			//$('.search .founded').html('<div class="statuse" data-search="'+id+'"></div>');
			$('.search .founded').html('<div class="statuse" data-search="'+id+'"><div id="found"></div><div class="progress"><div class="progress-bar progress-bar-danger" aria-valuenow="2" aria-valuemin="0" aria-valuemax="100" style="width: 2%; min-width:30px;">2%</div></div></div>'); 
		}	
		$('#found').html("Найдено <b class='all'>" + data.data['status']['hotelsfound'] + "</b> ");
		$('.statuse .progress .progress-bar')
		.css({
			'width': data.data['status']['progress'] + '%'
		})
		.text(data.data['status']['progress'] + '%')
		.attr('aria-valuenow', data.data['status']['progress'])
		
		if(data.data['status']['state']=='finished') {
		}
		else {
			setTimeout( function(){ checkState(id,page); }, 5000);
		}
		console.log(data);
		if(typeof data.data['result'] != 'undefined'){
			if("hotel" in data.data['result']) {
				

				$.each(data.data['result']['hotel'], function( i, v ){
					star='';
					for(k=1;k<=v.hotelstars;k++) star += '<span class="fa fa-star "></span>';

						var tours = '';
					$.each(v.tours['tour'], function( j, vl ){
						clr =''; if(j%2==0) clr ='gray'; 
						tours += '<div class="tr-price '+clr+'">';
						if(inGroup=='y') {
							tours += '<div class="td-oper">'+
							'<span data-operator="'+vl.operatorcode+'">'+vl.operatorname+'</span>'+
							'</div>';
						}
						tours += '<div class="td-tour">'+
						'<span>'+vl.tourname+'</span>'+
						'<span></span>'+
						'</div>'+
						'<div class="td-day">'+
						'<span>'+vl.flydate+'</span>'+
						'<span>'+vl.nights+' нч</span>'+
						'</div>'+
						'<div class="td-human">'+
						'<span>'+vl.adults+' взр</span>'+
						'<span>'+vl.child+' дет</span>'+
						'</div>'+
						'<div class="td-info">'+
						'<span>'+vl.room+'</span>'+
						'<span>'+vl.meal+' - '+vl.mealrussian+'</span>'+
						'</div>'+
						'<div class="td-price">'+
						'<span>'+vl.price+' Р</span>'+
						'</div>'+
						'<div class="tr-tour">'+
						'<a class="buythistour fa fa-chevron-right" data-tourid="'+vl.tourid+'">&nbsp;</a>'+
						'</div>'+
						'</div>';

					});
					menu = '';
					if(v.isphoto   =='1' ){ menu+='<a href="#" class="hotelmenu about">об отеле</a>';}
					if(v.iscoords =='1'){ menu+='<a href="#" class="hotelmenu map">на карте</a>'; }
					if(v.isreviews  =='1' ){ menu+='<a href="#" class="hotelmenu coments">отзывы</a>'; }
					if(v.isdescription  =='1' ){}


						if(!$("#h"+v.hotelcode).length) {

							if(inGroup == 'y') {
								var d = 'table-cell'
							}
							else {
								var d = 'none'
							}
							$('.search .founded').append('<div id="h'+v.hotelcode+'" class="hotelline" data-hotelid="'+v.hotelcode+'">'+
								'<div class="row ">'+
								'<div class="col-md-3">'+
								'<div class="photo"> <img src="'+v.picturelink+'" height="100%" alt="" /> </div>'+
								'</div>'+
								'<div class="col-md-9">'+
								'<div class="row">'+
								'<div class="col-md-9">'+
								'<div class="stars">'+star+'</div>'+
								'<h3>'+v.hotelname+' '+v.hotelstars+'*</h3>'+
								'<p class="country">'+v.regionname+', '+v.countryname+'</p>'+
								'<p class="hotelinfo">'+v.hoteldescription+'</p>'+
								'</div>'+
								'<div class="col-md-3">'+
								'<div class="row inforesult">'+
								'<div class="col-md-6">'+
								'<span class="vote">рейтинг</span>'+
								'<span class="votecount">'+v.hotelrating+'</span>'+
								'</div>'+
								'<div class="col-md-6">'+
								'<span class="from">от</span>'+
								'<span class="price">'+v.price+' Р</span>'+
								'<span class="forroom">за номер</span>'+
								'</div>'+
								'</div>'+
								'</div>'+
								'</div>'+
								'<div class="row">'+
								'<div class="col-md-8">'+menu+
								'<a href="#" class="hotelmenu prices">цены</a>'+
								'</div>'+
								'<div class="col-md-4">'+
								'<a href="#" class="getme hotelmenu prices online">Купить онлайн</a><a href="#" class="getme hotelmenu prices offline">Купить в офисе</a>'+
								'</div>'+
								'</div>'+
								'</div>'+
								'</div>'+
								'<div class="box-prices">'+
								'<div class="line-prices xline">'+
								'<div class="tbl-prices">'+
								'<div class="th-price">'+
								'<div style="display:'+d+'" class="tr-head">'+
								'<span>Туроператор</span>'+
								'</div>'+
								'<div class="tr-head">'+
								'<span>Тур</span>'+
								'</div>'+
								'<div class="tr-head">'+
								'<span>Вылет / ночей</span>'+ 
								'</div>'+
								'<div class="tr-head">'+
								'<span>Туристы</span>'+
								'</div>'+
								'<div class="tr-head">'+
								'<span>Номер/питание</span>'+
								'</div>'+
								'<div class="tr-head">'+
								'<span>Цена</span>'+
								'</div>'+
								'<div class="tr-head">'+
								'</div>'+
								'<div class="tr-head">'+
								'<span> </span>'+
								'</div>'+
								'</div>'+
								tours+
								'</div>'+
								'</div>'+
								'<div class="line-coments xline"></div>'+
								'<div class="line-map xline"></div>'+
								'<div class="line-about xline"></div>'+
								'<div class="footlinez">'+
								'<a href="/catalog/hotel/'+v.hotelcode+'" class="abouthotel">подробнее об отеле</a>'+
								'<a href="#" class="clo">X</a>'+
								'</div>'+
								'</div>'+
								'</div>');
						}
					});


$('.hotels-found-are-there').show()


}

}



inProgress = false;
},'json');

}

function incudez(t) {
	t.autocomplete({
		source: function(t, e) {
			$.getJSON("/ajax/inexclude.php?callback=?", t, function(t) {
				var a = t.error ? [] : $.map(t.list, function(t) {
					return {
						label: t.label,
						value: t.value,
						id: t.id
					}
				});
				e(a)
			})
		},
		select: function(t, e) {
			$(this).prev().val(e.item.id)
		}
	})
}

function acompl() {
	$(".hotelzname").autocomplete({
		source: function(t, e) {
			void 0 !== $('select[name="countryz"]').val() && void 0 !== $('select[name="curort"]').val() && $.getJSON("/ajax/touvisor.php?cntry=" + $('select[name="countryz"] :selected').data("cid") + "&hreg=" + $('select[name="curort"] :selected').data("kid") + "&callback=?", t, function(t) {
				var a = t.error ? [] : $.map(t.list, function(t) {
					return {
						label: t.label,
						value: t.value,
						id: t.id
					}
				});
				e(a)
			})
		},
		select: function(t, e) {
			$(this).prev().val(e.item.id), $(this).closest(".form-group").find(".urladr").hide()
		}
	})
}
function completme(w) {
	$("#comp-srch input[name=direction]").autocomplete({
		source: function(t, e) {
			$.getJSON("/ajax/touvisor.php?country=y&callback=?", t, function(t) {
				var a = t.error ? [] : $.map(t.list, function(t) {
					return {
						label: t.label,
						value: t.value,
						id: t.id
					}
				});
				e(a)
			})
		},
		select: function(t, e) {
			
		}
	})
}

function zoomForDeskTops() {
	if ($(window).width() > 1e3) {
		var t = 930,
		e = 1 / parseFloat(t.toFixed(3)),
		a = document.body.clientHeight,
		o = e * a;
		return o = parseFloat(o.toFixed(3))
	}
	return 1
}

function getName(t) {
	if (t.lastIndexOf("\\")) var e = t.lastIndexOf("\\") + 1;
	else var e = t.lastIndexOf("/") + 1;
	var a = t.slice(e),
	o = document.getElementById("fileformlabel");
	o.innerHTML = a
}

function getCityByIp(t, callback) {
	if(typeof callback == 'undefined') {
		callback = function(){}
	}
	$.ajax({
		type: "POST",
		url: "/ajax/city.php?city="+t,
		contentType: !1,
		processData: !1,
		dataType: "json",
		success: function(t) {

			var onlyonce = true

			//JSON.parse(data)
			console.log(t);
			console.log(t.length);
			if(t.length == 0) {
				$(".adressAll ul").html("");
				$(".navbar .phones b").text('');
				$(".navbar .phones .p2").text('');
			}
			str2 = "", t.length > 0 ? ($("li.addresses").show(),  $(".adressAll ul").html(""), $.each(t, function(t, e) {

				if(e.metro.length > 0 ){
					var displayMetro = ''
				}
				else{
					var displayMetro = 'none !important'
				}

				str = "<li><h3>" + e.adr + '</h3><ol><li><i class="fa fa-phone fa-lg red-style" ></i>' + e.phone + '</li><li ><i class="fa fa-clock-o fa-lg red-style" ></i>' + e.time + '</li><li style="display:'+displayMetro+'"><i class="fa fa-subway fa-lg red-style" ></i>' + e.metro + '</li><li><i class="fa  fa-map-marker  fa-lg red-style" ></i><a href="#" data-mapid="' + e.id + '" data-toggle="modal" data-target="#showmap">См. на карте</a></li></ol><br style="clear:both;"></li>', 

				$(".adressAll ul").append(str), 



				$(".navbar .phones b").text(e.phone), 

				$(".navbar .phones .p2").text(e.phone2), 

				$(".lastblock .phones .p1").text(e.phone), 

				$(".lastblock .phones .p2").text(e.phone2), e.vk ? ($(".lastblock .socials .vk").attr("href", "https://vk.com/"+e.vk), 

					$(".lastblock .socials .vk").show()) : $(".lastblock .socials .vk").hide(), e.inst ? ($(".lastblock .socials .inst").attr("href", e.inst), $(".lastblock .socials .inst").show()) : $(".lastblock .socials .inst").hide(), e.ok ? ($(".lastblock .socials .ok").attr("href", "https://ok.ru/group/"+e.ok), $(".lastblock .socials .ok").show()) : $(".lastblock .socials .ok").hide(), e.fb ? ($(".lastblock .socials .fb").attr("href", "https://www.facebook.com/"+e.fb), 
					$(".lastblock .socials .fb").show()) : $(".lastblock .socials .fb").hide();
					var a = 0;
					var y = 0; 

					if($("#BX_GMAP_googlemaps2").length > 0){


						$.each(e.pl, function(e, o) {


							BX_GMapAddPlacemark({
								LON: o.LON,
								LAT: o.LAT,
								TEXT: o.TEXT,
								cls: "marker" + t
							}, "googlemaps2") 

							a = o.LON; 
							y = o.LAT;
						})



						if(onlyonce){
							onlyonce = false
							BX_GMapPanTo(y, a, "googlemaps2")
							$(".office-carousel").on('translated.owl.carousel', function(e){
							// if($('.office-carousel .item').length - $('.office-carousel .item.active').index() == 1){
							// 	var lonCoord = $('.office-carousel .item.active').next().data('lon')
							// 	var latCoord = $('.office-carousel .item.active').next().data('lat')
							// }
							// else {
								var lonCoord = $('.office-carousel .owl-item.active .item').data('lon')
								var latCoord = $('.office-carousel .owl-item.active .item').data('lat')

							// }
							// console.log(lonCoord + ' ' + latCoord)
							BX_GMapPanTo(latCoord, lonCoord, "googlemaps2")
						})

						}

					}  


					// console.log( a )
					// console.log( a + 0.1 )


					$(".office-carousel").length && (str2 += '<div data-lon="'+a+'" data-lat="'+y+'" class="item marker' + t + '"><div class="row office" ><div class="col-md-9 " ><h3>' + e.name + "</h3>" + e.adr + '</div><div class="col-md-3 " ><div class="ofcepic"><img src="' + e.pic + '" ></div></div></div><div class="officefull"><div class="row " ><div class="col-md-7 col-xs-7" ><h3>' + e.name + "</h3>" + e.fname + '</div><div class="col-md-5 col-xs-5" ><div class="ofcepicbig"><img src="' + e.pic + '" ></div></div></div><div class="row " ><div class="col-md-6 col-xs-6 " ><p><i class="fa fa-calendar-o redish"></i></p><p><b>Пн-Пт:</b>' + e.time + "</p><p><b>Сб,Вс:</b> " + e.holiday + '</p></div><div class="col-md-6 col-xs-6 " ><p><i class="fa fa-phone redish"></i></p><p><b>' + e.phone + "</b></p><p>" + e.phone2 + "</p></div></div></div></div>")
				}), $(".office-carousel").length && $(".office-carousel").html(str2)) : ($("li.addresses").hide() , console.log(t.length))

			if($(".office-carousel.owl-loaded").length > 0){
				$(".office-carousel").owlCarousel('destroy');


			}
			
			$(".office-carousel").owlCarousel({
				loop: !1,
				margin: 10,
				dots: !1,
				items: 1,
				nav: true
			})
			



			if(callback()) {
				callback()
			}
		}
	}).fail(function(jqXHR, textStatus, errorThrown){
		console.log(textStatus)
	}) 
}

function catalCountry() {
	$.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=country&callback=?", function(t) {
		var e = "";
		k = t.lists.countries.country.length / 4, k = Math.ceil(k);
		for (var a = 0; a < t.lists.countries.country.length; a++) a % k == 0 && (e += "</div>"), (0 == a || a % k == 0) && (e += '<div class="col-md-3 nopad">'), tran = transliterate(t.lists.countries.country[a].name), tran = tran.replace(/\ /g, "-"), e += '<a href="/catalog/country/tid' + t.lists.countries.country[a].id + '" class="flag "><img src="/images/Flags/png/' + tran.toLowerCase() + '.png" alt="' + t.lists.countries.country[a].name + '" /> ' + t.lists.countries.country[a].name + "</a>";
			$(".allcountry").html(e)
	})
}

function checkPrice(ob) {
	$.ajax({
		url: "/ajax/check.php",
		data: {
			dataid: ob.data("tourid")
		},
		success: function(t) {
			$(".box-price-check div:first-child").html(t + 'P')
		}
		
	}).done(function(t) {
		$(".box-price-check div:first-child").html(t)
	})
}
$.fn.extend({
	animateCss: function(t) {
		var e = "webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";
		this.addClass("animated " + t).one(e, function() {
			$(this).removeClass("animated " + t)
		})
	}
});
var $grid, inProgress = !1;


if ($("#chart").length) {
	


	var ctx = $("#chart"),
	ctxx = document.getElementById("chart").getContext("2d"),
	grd = ctxx.createLinearGradient(0, 0, 0, 250);
	grd.addColorStop(0, "rgb(221, 64, 64)"), grd.addColorStop(1, "white");


	grd1 = ctxx.createLinearGradient(0, 0, 0, 250);
	grd1.addColorStop(0, "gray"), grd1.addColorStop(1, "white");

	var datasettings = {
		labels:  ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"],
		datasets: [{
			type: "line",
			label: "Обьем продаж",
			data: [null, null, 180, 240, 300, 360, 420, 480, 540, 600, 660, 720],
			pointBorderColor: "rgb(221, 64, 64)",
			pointBackgroundColor: "#fff",
			borderColor: "rgba(221, 64, 64,1)",
			backgroundColor: grd,
			fill: true
		}, {
			type: "line",
			label: "Обьем продаж",
			data: [60, 120, 180],
			pointBorderColor: "gray",
			pointBackgroundColor: "#fff",
			borderColor: "gray",
			backgroundColor: grd1,
			fill: true
		}]
	}

	var setOptions ={
		scales: {
			yAxes: [{
				ticks: {
					display: true
				}
			}]
		},
		responsive: true,
		responsiveAnimationDuration: 1500,
		legend: {
			display: !1
		},
		elements: {
			points: {
				borderWidth: 1,
				borderColor: "rgb(221, 64, 64)"
			}
		},
		title: {
			display: true,
			text: 'График прибыли от франшизы в вашем городе'
		}
	}

	window.myChart = new Chart(ctx, {
		type: "line",
		data: datasettings,
		options: setOptions
	})




	$('#submitchart').click(function(e){
		e.preventDefault()

	// ----------------Получение данных формы----------------
	var citizens_amount = parseInt($('#citizens_amount').val())
	var cntcity = $('#cntcity').val()
	var fmonth = parseInt($('#fmonth').val())
	var nmonth = parseInt($('#nmonth').val())
	var lmonth = parseInt($('#lmonth').val())

	// ----------------Получение индексов актуальных месяцев на основе введенных данных----------------
	var now = new Date();
	var thisMounth = now.getMonth()
	var lastMounth = thisMounth - 1
	var secondMounth = thisMounth - 2
	var firstMounth = thisMounth - 3

	var startCount = parseInt((lmonth+nmonth+fmonth)/3)


	// ----------------Интерпретация индексов в названия, создание тайтлов Ox----------------

	var mounthInterpretator = ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"]
	var lastMounthName = mounthInterpretator[lastMounth]
	var secondMounthName = mounthInterpretator[secondMounth]
	var firstMounthName = mounthInterpretator[firstMounth]

	var mounthTitleData = [firstMounthName, secondMounthName, lastMounthName]

	var indexCoef = thisMounth;

	for(var i = 3; i < 12; i++){
		if(indexCoef == 12) {
			indexCoef = 0;
		}
		mounthTitleData[i] = mounthInterpretator[indexCoef]
		indexCoef++
	}

	// ------------Множители по месяцам и рассчет вместе с населением------------

	var mounthEarningsCoefArr = [1.1, 0.85, 1.1, 1.15, 1.05, 1.15, 1.2, 1.05, 0.95, 0.93, 0.9, 1.15]
	var amountCitizensEarningsCoefArr = [1, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07, 1.08, 1.09]

	var amountCitizensEarningsCoef = amountCitizensEarningsCoefArr[citizens_amount]

	var startResult = [fmonth, nmonth, lmonth]

	var startCountofEarnIndex = mounthInterpretator.indexOf(mounthTitleData[3])

	var result = startCount

	var resultArr = ["null","null", startResult[2]]

	for(var i = 3; i < 12; i++) {
		if(startCountofEarnIndex == 12) {
			startCountofEarnIndex = 0;
		}
		result = result * mounthEarningsCoefArr[startCountofEarnIndex]
		result = result * amountCitizensEarningsCoef

		resultArr[i] = parseInt(result)

		startCountofEarnIndex++
		
	}

	console.log(resultArr)

	datasettings.labels = mounthTitleData; 
	datasettings.datasets[0].data = resultArr
	datasettings.datasets[1].data = startResult
	setOptions.title.text =  cntcity

	

	window.myChart.update();
	


	

})








}




var orderArray = ['podbor', 'sale', 'officeorder', 'backcall', 'quest']

orderArray.forEach(function(item, i, arr){
	workingWithOrders(item)
})




$("video").length > 0 && plyr.setup({
	controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 'captions', 'fullscreen']
}), $(document).on("click", ".lostpwd", function(t) {
	t.preventDefault(), $("#login").modal("hide"), $("#forgot").modal("show")
}), $(document).on("submit", 'form[name="bform"]', function(t) {
	t.preventDefault(), $.post($(this).attr("action"), $(this).serialize(), function(t) {
		$("#forgot").modal("hide"), $("#answer .modal-content").html("<b>" + t + "</b>"), Recaptchafree.reset(), $("#answer").modal("show")
	})
}), $(document).on("click", ".regbtn", function(t) {
	t.preventDefault(), $("#login").modal("hide"), $("#registar").modal("show")
}), $(document).on("click", ".listblockcity .letterlist a", function(t) {


	t.preventDefault(), $(".adressAll").hide(), id = $(this).data("city"), $.get("/ajax/office.php", {
		city: id
	}, function(t) {
		$(".reloadOffice").html('<p class="office-adress"><b>' + t.name + "</b>" + t.addr + '</p><ul class="office-box-info"><li><i class="calendar2"></i><p><b>Пн-Пт:</b> ' + t.hours + "</p><p><b>Сб,Вс:</b> " + t.holiday + '</p></li><li><i class="fa fa-phone fa-lg red-style"></i><p><b>' + t.phone + "</b></p><p>" + t.phone2 + "</p></li></ul>"), str = "", t.employ && ($.each(t.employ, function(t, e) {
			str += '<div class="item"><div class="people"><img src="' + e.img + '"><p><b>' + e.name + "</b> <span>" + e.post + "</span></p></div></div>"
		}), $(".peopl-carusel").trigger("replace.owl.carousel", str)), $.each(t.placemark, function(t, e) {
			BX_GMapAddPlacemark({
				LON: e.LON,
				LAT: e.LAT,
				TEXT: e.TEXT
			}, "googlemaps")
		}), BX_GMapPanTo(t.lat, t.lon, "googlemaps")
	}, "json")








}), $(document).on("click", ".cityAll .letterlist a", function(t) {

	t.preventDefault(), id = $(this).data("city"), txt = $(this).text(), $(".adressAll").hide(), $(".fz-city :contains('" + txt + "'), .city_departure :contains('" + txt + "')").attr("selected", "selected"), 

	getCityByIp(id, function(){
		if($('#fullPage').length == 0){
			window.location = '/'
		}
	});

	var e = $(this).attr("data-citytv");
	var city_id = $(this).attr("data-city");
	load_tours(e, city_id, true)



	$('.city_departure').text(txt)
	$('.adressAll .choodeTown').html(txt+'<i class="glyphicon glyphicon-triangle-bottom" style="color:#db3636;font-size:0.5em;margin-right: 20px;"></i>')
}), 




$(document).on("click", ".cityAll2 .letterlist a", function(t) {

	t.preventDefault(), id = $(this).data("city"), txt = $(this).text(), $(".fz-city :contains('" + txt + "'), .city_departure :contains('" + txt + "')").attr("selected", "selected"), 

	getCityByIp(id, function(){
		if($('#fullPage').length == 0){
			window.location = '/'
		}
	});

	var e = $(this).attr("data-citytv");
	var city_id = $(this).attr("data-city");
	load_tours(e, city_id, true)
	var tx = $(this).text()


	$('.city_departure').text(tx)
	$('.adressAll .choodeTown').html(tx+'<i class="glyphicon glyphicon-triangle-bottom" style="color:#db3636;font-size:0.5em;margin-right: 20px;"></i>')
}),




$(document).on("change", ".modal-content .form-group input", function() {
	$(this).val().length > 3 ? 0 == $(this).closest(".form-group").find("formsucico").length && ($(this).after('<span class="glyphicon glyphicon-ok formsucico"></span>'), $(this).closest(".form-group").addClass("has-success")) : (ob = $(this).closest(".form-group"), ob.find("formsucico").remove(), ob.removeClass("has-success"))
}), $(document).on("submit", "#loginForm", function() {
	var t = $(this),
	e = {
		action: t.attr("action"),
		post: {
			ajax_key: ajaxLicKey
		}
	};
	return $.each($("input", t), function() {
		$(this).attr("name").length && (e.post[$(this).attr("name")] = $(this).val())
	}), $.post(e.action, e.post, function(e) {
		$("input", t).removeAttr("disabled"), "error" == e.type ? $("#login .modal-body").prepend('<p class="bg-danger">' + e.message + "</p>") : window.location = "/lk/"
	}, "json"), !1
}), $(document).on("keyup", ".latinz", function(t) {
	v = $(this).val(), v = v.replace(/[^a-z0-9_-]+/i, ""), $(this).val(v)
}), $(document).on("change", "select[name=night_ot]", function(t) {
	$("select").styler("destroy"), v = parseFloat($(this).val()), x = v + 14, $("select[name=night_do] option").remove();
	for (var e = v; e <= x; e++) $("select[name=night_do]").append('<option value="' + e + '">' + e + "</option>");
		initDropdown()
}), 


$(document).on("submit", "#callback form", function(t) {
	t.preventDefault();
	var e = $(this).serialize() + "&web_form_submit=Y";
	getForm(3, e, $(this))
}),


$(document).on("submit", "#question form", function(t) {
	t.preventDefault();
	var e = $(this).serialize() + "&web_form_submit=Y";
	getForm(2, e, $(this))
}),


$(document).on("submit", "#employe form", function(t) {
	t.preventDefault();
	var e = $(this).serialize() + "&web_form_submit=Y";
	getForm(7, e, $(this))
}), 


$(document).on("submit", "#jobform form", function(t) {
	t.preventDefault();
	var e = $(this).serialize() + "&web_form_submit=Y";
	getForm(6, e, $(this))
}), 
console.log($('.itmbl').length),

$(document).on("submit", "#orderfor form", function(t) {
	t.preventDefault();
	var e = $(this).serialize() + "&web_form_submit=Y";
	getForm(5, e, $(this))
}), 


$(document).on("submit", "#soc form", function(t) {
	t.preventDefault();
	var e = $(this).serialize() + "&web_form_submit=Y";
	getForm(9, e, $(this))
}), 
console.log($('.itmbl').length),

$(document).on("submit", "#order form", function(t) {
	t.preventDefault();
	var e = $(this).serialize() + "&web_form_submit=Y";
	getForm(5, e, $(this))
}), 

console.log($('.itmbl').length),

$(document).on("click", ".full-news img", function(t) {
	t.preventDefault(), $(".imagepreview").attr("src", $(this).attr("src")), $("#imagemodal").modal("show")
}), 
console.log($('.itmbl').length),

$(window).width() < 1e3 && ($("#franchize").after('<section class="vertical-scrolling"  id="teach"><div class="container franch" ><div  class="row row-flex row-flex-wrap" ><div class="col-xs-12" >' + $("#franchize .mobile-section").html() + "</div></div></div></section>"), $("#articles").after('<section class="vertical-scrolling"  id="artic"><div class="container reviewnart" ><div  class="row" ><div class="col-xs-12 articles" >' + $("#articles .articles").html() + "</div></div></div></section>"), $("#articles .articles").remove()),  $(document).ready(function() { $("body,html").animate({scrollTop: 0}, 400);  //$(window).width() < 1e3 ? $(".onlyPc").remove():'',
	$(".sliderhotel .hotel.nobgr").length && getPic(), $("input[name=form_hidden_82]").length && $("input[name=form_hidden_82]").val(userCity), $("input[name=form_hidden_83]").length && $("input[name=form_hidden_83]").val(userCity), $("input[name=form_hidden_40]").length && $("input[name=form_hidden_40]").val(userCity), $("#touradd").length && ($.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=operator&callback=?", function(t) {
		for (var e = '<option value="0">выберите</option>', a = 0; a < t.lists.operators.operator.length; a++) t.lists.operators.operator[a].russian == $(".turopers").data("editid") ? sel = "selected" : sel = "", e = e + '<option value="' + t.lists.operators.operator[a].russian + '" ' + sel + ">" + t.lists.operators.operator[a].russian + "</option>";
			$(".turopers").html(e), refresher()
	}),
	console.log($('.itmbl').length),

	$.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=departure&callback=?", function(t) {
		for (var e = "<option value='0'>Выберите город</option>", a = 0; a < t.lists.departures.departure.length; a++) t.lists.departures.departure[a].name == $('select[name="cityz"]').data("editid") ? sel = "selected" : sel = "", e = e + "<option value='" + t.lists.departures.departure[a].name + "' data-tvid='" + t.lists.departures.departure[a].id + "' " + sel + ">из " + t.lists.departures.departure[a].name + "</option>";
			$('select[name="cityz"]').html(e), refresher()
	}), "" != $('select[name="countryz"]').data("editid") && getCountryz(), "" != $('select[name="curort"]').data("editid") && getCurort(), $(document).on("change", 'select[name="cityz"]', function() {}), $(document).on("change", 'select[name="countryz"]', function(t) {
		getCurort()
	}), 
	console.log($('.itmbl').length),

	$(document).on("change", 'select[name="curort"]', function(t) {
		"0" !== $(this).val() ? ($(".hiddenifneed").hide(), $("input[name=curort_new]").val("")) : $(".hiddenifneed").show()
	})),
	console.log($('.itmbl').length),
	$('select[name="cityID"]').length && ($.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=departure&callback=?", function(t) {
		for (var e = "", a = userCity, o = 0; o < t.lists.departures.departure.length; o++) a == t.lists.departures.departure[o].name ? ccity = " selected" : ccity = "", e = e + "<OPTION value='" + t.lists.departures.departure[o].id + "'" + ccity + ">" + t.lists.departures.departure[o].name + "</OPTION>";
			$('select[name="cityID"]').html(e)
	}).done(function() {
		getCountry()
	}), 
	console.log($('.itmbl').length),
	$(document).on("change", 'select[name="cityID"]', function() {
		getCountry()
	})), $(".turoperators").length && $.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=operator&callback=?", function(t) {
		for (var e = "", a = 0; a < t.lists.operators.operator.length; a++) e = e + '<li><span class="checkme"></span><input type="checkbox" name="operator[]" value="' + t.lists.operators.operator[a].id + '" class="hidecheck">  <label class="checkb">' + t.lists.operators.operator[a].russian + "</label></li>";
			$(".turoperators").html(e)
	}), $(".regionskurort").length && (cntr = "", $('select[name="countryID"]').val() && (cntr = "&regcountry=" + $('select[name="countryID"]').val()), $.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=region" + cntr + "&callback=?", function(t) {
		for (var e = "", a = 0; a < t.lists.regions.region.length; a++) e = e + '<li><span class="checkme"></span><input type="checkbox" name="curort[]" value="' + t.lists.regions.region[a].id + '" class="hidecheck" id="kid' + t.lists.regions.region[a].id + '" data-country="' + t.lists.regions.region[a].country + '"/>  <label class="checkb" for="kid' + t.lists.regions.region[a].id + '">' + t.lists.regions.region[a].name + "</label></li>";
			$(".regionskurort").html(e)
	}), 
	console.log($('.itmbl').length),
	$(document).on("change", 'select[name="countryID"]', function(t) {
		id = $(this).val(), cntr = "&regcountry=" + id, $.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=region" + cntr + "&callback=?", function(t) {
			for (var e = "", a = 0; a < t.lists.regions.region.length; a++) e = e + '<li><span class="checkme"></span><input type="checkbox" name="curort[]" value="' + t.lists.regions.region[a].id + '" class="hidecheck" id="kid' + t.lists.regions.region[a].id + '" data-country="' + t.lists.regions.region[a].country + '"/>  <label class="checkb" for="kid' + t.lists.regions.region[a].id + '">' + t.lists.regions.region[a].name + "</label></li>";
				$(".regionskurort").html(e)
		})
	})), 
	console.log($('.itmbl').length),
	$(".hotelscheck").length && ($('select[name="countryID"]').val() && hotelsReload(), $(document).on("change", 'select[name="countryID"]', function(t) {
		hotelsReload()
	}), $(document).on("change", 'input[name="curort[]"]', function(t) {
		hotelsReload()
	}),
	console.log($('.itmbl').length),
	$(document).on("change", 'select[name="raiting"]', function(t) {
		hotelsReload()
	}), $(document).on("click", ".starq label", function(t) {
		t.preventDefault(), $(this).prev().attr("checked", !0), hotelsReload()
	}))
}), 
console.log($('.itmbl').length),
$(document).on("click", "#addRewv .submt", function(t) {
	var e = new FormData($("form#addRewv")[0]);
	$.ajax({
		type: "POST",
		url: "/ajax/addrewv.php",
		data: e,
		contentType: !1,
		processData: !1,
		success: function(t) {
			"ok" == t ? ($("#addrewiev").modal("hide"), $("#addRewv")[0].reset(), $("#answer .modal-content").html('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>Спасибо, ваш отзыв принят на модерацию!</h1><p></p></div>')) : $("#answer .modal-content").html(t), $("#answer").modal("show")
		}
	})
}),
console.log($('.itmbl').length),
$(document).on("click", ".closeNews", function(t) {
	$(".topNews").remove()
}), $(document).on("change", 'input[name="coverimage"]', function(t) {
	for (var e, o = t.target.files, n = 0; e = o[n]; n++)
		if (e.type.match("image.*")) {
			var i = new FileReader;
			i.onload = function(t) {
				return function(e) {
					a = e.target.result, b = escape(t.name), $("#loadpic").html('<img class="thumb" src="' + a + '" title="' + b + '"/>'), $("#loadpic").removeClass("fa"), $("#loadpic").removeClass("fa-photo")
				}
			}(e), i.readAsDataURL(e)
		}
	}), 
console.log($('.itmbl').length),
$(document).on("change", 'input[name="PERSONAL_PHOTO"]', function(t) {
	for (var e, o = t.target.files, n = 0; e = o[n]; n++)
		if (e.type.match("image.*")) {
			var i = new FileReader;
			i.onload = function(t) {
				return function(e) {
					a = e.target.result, b = escape(t.name), $(".ava").html('<img class="thumb" src="' + a + '" title="' + b + '"/>')
				}
			}(e), i.readAsDataURL(e)
		}
	}), $(document).on("change", 'input[name="cover"]', function(t) {
		for (var e, o = t.target.files, n = 0; e = o[n]; n++)
			if (e.type.match("image.*")) {
				var i = new FileReader;
				i.onload = function(t) {
					return function(e) {
						a = e.target.result, b = escape(t.name),
						$(".pict").html('<img class="thumb" src="' + a + '" title="' + b + '" width="100%"/>')
					}
				}(e), i.readAsDataURL(e)
			}
		}), $(document).on("click", ".addpicfortour", function(t) {
			$('input[name="coverimage"]').click()
		}), 



		$('#touradd select[name="cityz"]').change(function(){
			$(this).attr('data-tvid', $(this).find('option[value="'+$(this).val()+'"]').data('tvid'))
		})


		$(document).on("submit", "#touradd", function(t) {
			if (t.preventDefault(), txt = "", "0" == $("select[name=cityz]").val() || "0" == $("select[name=countryz]").val() || "0" == $("select[name=curort]").val() && "" == $("input[name=curort_new]").val()) $("#answer .modal-content").html('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>Обязательные поля не заполнены</h1><p>' + txt + "</p></div>"), $("#answer").modal("show");
			else {
				var e = new FormData($("form#touradd")[0]);
				var tvid = $('#touradd select[name="cityz"]').attr('data-tvid');

				e.append('tvid', tvid);


				$.ajax({
					type: "POST",
					url: "/ajax/addTour.php",
					data: e,
					contentType: !1,
					processData: !1,
					dataType: "json",
					beforeSend: function() {
						$(".activebtn").before('<i class="fa fa-cloud-download"></i>'), $(".activebtn").hide()
					},
					success: function(t) {
						t.success ? ($(".hot-list table tbody").prepend('<tr><th scope="row">' + t.id + "</th><td>" + $("select[name=cityz]").val() + " - " + $("select[name=countryz]").val() + "(" + $("select[name=curort]").val() + ")</td><td>из " + $("select[name=cityz]").val() + "</td> <td>" + $("select[name=countryz]").val() + "/" + $("select[name=curort]").val() + "</td>  <td>" + $(".fromdatewl").val() + ',<br></td> <td><s></s><br> </td> <td> </td> <td><span class="green">Показывать</span></td> <td><div class="form-group "><input name="sortindex" class="form-control" data-id="' + t.id + '" value="500"></div></td> <td><a class="edit fa fa-pencil" data-id="' + t.id + '"></a> <a class="copy fa  fa-copy" data-id="' + t.id + '"></a> <a class="delete fa  fa-trash-o" data-id="' + t.id + '"></a></td></tr>'), $(".activebtn").show(), $("#answer .modal-content").html('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>' + t.success + "</h1><p>" + t.description + "</p></div>"), $(".lk-menu button:first-child").click()) : $("#answer .modal-content").html(t), $("#answer").modal("show")
					}
				})
			}
		}), $(document).on("submit", "form#discounts", function(t) {
			t.preventDefault();
			var e = new FormData($("form#discounts")[0]);
			$.ajax({
				type: "POST",
				url: "/ajax/discounts.php",
				data: e,
				contentType: !1,
				processData: !1,
				dataType: "json",
				success: function(t) {
					t.success ? $("#answer .modal-content").html('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>' + t.success + "</h1><p>" + t.description + "</p></div>") : $("#answer .modal-content").html(t.er), $("#answer").modal("show")
				}
			})
		}), $(document).on("click", "button.action", function(t) {
			$(".tabz").addClass("disabled"), id = $(this).data("id"), $(".hot-" + id).removeClass("disabled"), $("button.action").removeClass("active"), $(this).addClass("active")
		}), $(document).on("click", ".newpreson h1 span", function(t) {
			t.preventDefault(), $(this).closest(".newpreson").remove()
		}), $(document).on("click", ".dropthat", function(t) {
			t.preventDefault(), $(this).closest(".newpreson").remove()
		}), $(document).on("click", ".addchild", function(t) {
			t.preventDefault(), forma = $(".touristik").html(), forma = '<div class="newpreson"><h1>Добавление ребенка <span>X</span></h1>' + forma + '<a class="dropthat">отменить</a></div>', $(this).closest(".row").before(forma)
		}), $(document).on("click", ".addtourists", function(t) {
			t.preventDefault(), forma = $(".touristik").html(), forma = '<div class="newpreson"><h1>Добавление туриста <span>X</span></h1>' + forma + '<a class="dropthat">отменить</a></div>', $(this).closest(".row").before(forma)
		}), $(document).on("change", "input[name=kount]", function() {
			k = $(this).val(), id = $("input[name=touridonline]").val()
		}), $(document).on("click", "#buyme .byeme", function() {
			window.location.href = "/order/" + $("input[name=touridonline]").val() + "?k=" + $("input[name=kount]").val()
		}), 

		$(document).on("change", "#summapay", function(t) {
			s = $(this).val(), $("input[name=Amount]").val(''+(parseFloat($("input[name=SUM]").val()) / 100 * parseFloat(s))+'.00'),
			$("input[name=OrderId]").val($(".order").data("orderid"))
		}), $(document).on("click", ".sale-order-detail-payment-options-methods-button-element", function(t) {
			$(".sale-order-detail-payment-options-methods-information-block").hide(), $(".sale-order-detail-payment-options-methods-template").show()
		}), $(document).on("click", ".showmeall", function(t) {
			$(".fulltable").hide(), $(this).next().find(".fulltable").show()
		}), $(document).on("click", ".saveorderform", function(t) {
			t.preventDefault(), $(this).hasClass("checkex") ? $.get("/ajax/save.php", $("#bigorder").serialize(), function(t) {
				"ok" == t.suc && (
					window.location.href = "/order/success.php?id=" + t.id)

			}, "json") : ($("#answer .modal-content").html("Необходимо проверить цену перед покупкой тура"), $("#answer").modal("show"))
		}), 





		$(document).on("click", ".subscr", function() {
			switch (soc = $.trim($(this).attr("class").replace("subscr", "")), soc) {
				case "whatsap":
				id = 69, name = "What's App";
				break;
				case "viber":
				id = 70, name = "Viber";
				break;
				case "telegram":
				id = 71, name = "Telegram";
				break;
				default:
				id = 72, name = "SMS"
			}

			$.ajax({
				url: "/ajax/getsocform.php?getsoc=true",
				type: "POST",
				success: function(e) {

					$("#soc .modal-content").html(e)
					Recaptchafree.reset()

					$("#soc #myModalLabel").html("Подписка на " + name + " рассылку"), 
					$("input[name=form_text_74]").val(userCity),
					$("input[name=form_dropdown_social]").val(id)
					$('input[name="form_text_73"]').mask('+7(999) 999-99-99')

					$("#soc").modal("show")
				}
			})


		}), 



		$(document).on("click", ".hotlistover p", function() {

			window.location.href = $(this).closest('.list-wrapper').data('url')
		}), 



		$(document).on("click", ".switchlang", function() {
			l = $(this).data("letter"), $(".letter").removeClass("sels"), $(".switchlang").removeClass("selec"), $(this).addClass("selec"), $(".letter." + l).addClass("sels")
		}), $(document).on("change", 'select[name="srch_kur_name"]', function() {
			foundHotel()
		}), $(document).on("change", 'select[name="srch_cat_name"]', function() {
			foundHotel()
		}), $(document).on("click", ".letter a", function() {
			$(".letter a").removeClass("act"), $(this).addClass("act"), foundHotel()
		}), $("input[name=filter_city]").length && $("input[name=filter_city]").autocomplete({
			source: function(t, e) {
				null !== $("input[name=filter_city]").val() && $.getJSON("/ajax/touvisor.php?city=1&callback=?", t, function(t) {
					var a = t.error ? [] : $.map(t.list, function(t) {
						return {
							label: t.label,
							value: t.value,
							id: t.id
						}
					});
					e(a)
				})
			}
		}), $("input[name=filter_country]").length && $("input[name=filter_country]").autocomplete({
			source: function(t, e) {
				null !== $("input[name=filter_country]").val() && $.getJSON("/ajax/touvisor.php?country=1&callback=?", t, function(t) {
					var a = t.error ? [] : $.map(t.list, function(t) {
						return {
							label: t.label,
							value: t.value,
							id: t.id
						}
					});
					e(a)
				})
			}
		}), $(document).on("change", 'input[name="filter_country"]', function(t) {
			t.preventDefault(), searchrow()
		}), $(document).on("change", 'input[name="filter_city"]', function(t) {
			t.preventDefault(), searchrow()
		}), $(document).on("click", ".searchline button", function(t) {
			t.preventDefault(), searchrow()
		}), 





		$(document).on("click", "#searchbtnb", function() {
			window.location.href = "/search/"
		}), $(document).on("click", "#docs .send", function(t) {
			$.get("/ajax/lkfiles.php", {
				id: $(this).closest("tr").data("rowid"),
				action: "send"
			}, function(t) {
				"" !== t && (window.location.href = t)
			})
		}), $(document).on("click", "#docs .download", function(t) {
			$.get("/ajax/lkfiles.php", {
				id: $(this).closest("tr").data("rowid"),
				action: "download"
			}, function(t) {
				"" !== t && (window.location.href = t)
			})
		}), $(document).on("click", "#docs .print", function(t) {
			$.get("/ajax/lkfiles.php", {
				id: $(this).closest("tr").data("rowid"),
				action: "print"
			}, function(t) {
				"" !== t && (window.location.href = t)
			})
		}), $(document).on("click", "#docs .delete", function(t) {
			ob = $(this), $.get("/ajax/lkfiles.php", {
				id: ob.closest("tr").data("rowid"),
				action: "del"
			}, function(t) {
				"ok" == t && ob.closest("tr").remove()
			})
		}), $(document).on("click", "form#loadFile button", function(t) {
			t.preventDefault(), "" == $(".docsName").val() ? alert("укажите название файла") : $('input[name="upload"]').click()
		}), $(document).on("change", 'form#loadFile input[name="upload"]', function(t) {
			if (t.preventDefault(), "" == $(".docsName").val()) alert("укажите название файла");
			else {
				$("form#loadFile button").attr("disabled", !0);
				var e = $("#progressbar"),
				a = new FormData($("form#loadFile")[0]);
				$.ajax({
					type: "POST",
					url: "/ajax/lkfiles.php",
					data: a,
					contentType: !1,
					processData: !1,
					dataType: "json",
					xhr: function() {
						var t = $.ajaxSettings.xhr();
						return t.upload.addEventListener("progress", function(t) {
							if (t.lengthComputable) {
								var a = Math.ceil(t.loaded / t.total * 100);
								e.val(a).text("Загружено " + a + "%")
							}
						}, !1), t
					},
					success: function(t) {
						t.success ? ($("#docs table").append('<tr data-rowid="' + t.id + '"><td>' + $(".docsName").val() + "</td><td>" + t.date + '</td><td><i class="fa fa-paper-plane-o send"></i><i class="fa fa-download download "></i><i class="fa fa-print print "></i><i class="fa fa-remove delete"></i></td></tr>'), $(".docsName").val(""), $("form#loadFile button").attr("disabled", !1)) : ($("#answer .modal-content").html(t.er), Recaptchafree.reset(), $("#answer").modal("show"))
					}
				})
			}
		}), $(document).on("click", ".voteemploy", function() {
			$(".dropemploy").find("option:contains('" + $(this).data("imya") + "')").attr("selected", "selected"), $(".idemploy").val($(this).data("id"))
		}), 



		$(document).on("click", ".subscbtn", function() {
			$.ajax({
				url: "/ajax/ajax.php", 
				type: "POST",
				data: {
					email: $(".subscinp").val(),
					action: "email",
					town: $('.navbar li.citys span').text()
				},
				success: function(t) {
					$("#answer .modal-content").html('<h2>'+t+'</h2>'), Recaptchafree.reset(), $("#answer").modal("show")
					$(".subscbtn").siblings('input').val('')
				}

			})
		}),

		$(document).on("submit", "form[name = form_5]", function() {
			var email = $('input[name = form_email_36]').val(),
				town = $('input[name = form_hidden_40]').val(),
				action = 'email',
				data = $(this).serialize();

			$.ajax({
				url: "/ajax/ajax.php",
				type: "POST",
				data: {
					email: email,
					action: action,
					town: town,
					data: data
				},
				success: function(res) {
					console.log(res);
				}
			})	
		}),



		$(document).on("click", ".job-box .more", function() {
			$("#jobinfo").modal("show")
		}), $(document).on("click", ".expandMenu", function() {
			$(".navigation").show()
		}), $(document).on("click", ".cl", function() {
			$(".navigation").hide()
		}), $(document).on("click", ".citys span, .cityAll2 a", function() {
			"none" == $(".cityAll").css("display") && ($(".cityAll").show(), $(".cityAll").height($("#cityx").height()), $.fn.fullpage.setAllowScrolling(!1))
		}), $(document).on("mouseleave", ".cityAll", function(t) {
			$(".cityAll").hide(), $.fn.fullpage.setAllowScrolling(!0)
		}), $(document).on("mouseleave", ".navigation", function(t) {
			$(".navigation").hide()
		}), $(document).on("mouseleave", ".addresses", function(t) {
			$(".adressAll").hide()
		}), $(document).on("click", ".addresses", function() {
			$(".adressAll").show()
		}), $(document).on("change", 'select[name="child"]', function(t) {



			$("select").styler("destroy");
			cnt = $(this).val();
			var e = ""
			if(cnt != 0){
				a = "<p>Возраст детей</p>"
			}
			else {
				a = ''
			}

			$(".childs").css("color", "#c9c9c9"), $(this).css("color", "#db3636");
			for (var o = 1; 17 >= o; o++) e += '<option value="' + o + '">' + o + "</option>";
				for (var o = 1; o <= cnt; o++) a += '<div class="col-md-3"><select  name="child' + o + '" >' + e + "</select></div>";
					$(".ageOfChildz").html('<div class="form-group">' + a + "</div>"), refresher()
				initDropdown();
			}), 




		$(document).on("click", ".childs", function(t) {
			cnt = $(this).data("count");
			var e = "",
			a = "<h3>Возраст детей</h3>";
			$(".childs").css("color", "#c9c9c9"), $(this).css("color", "#db3636");
			for (var o = 1; 17 >= o; o++) e += '<option value="' + o + '">' + o + "</option>";
				for (var o = 1; o <= cnt; o++) a += '<select class="form-control" name="child' + o + '" >' + e + "</select>";
					$(".childyear").html(a), $('input[name="child"]').val(cnt), $(".pplcount .cntchld").length ? $(".pplcount .cntchld").html("Дет.: " + cnt) : (fa = $('.turist[style*="rgb(219, 54, 54)"]'), cntt = fa.data("count"), $(".pplcount").html('<span class="cntparnt">Взр.: ' + cntt + '</span> <span class="cntchld">Дет.: ' + cnt + '</span> <i class="fa fa-sort-down"></i>')), refresher()
			}), $(document).on("click", ".turist", function(t) {
				cnt = $(this).data("count"), $('input[name="adult"]').val(cnt), $(".turist").css("color", "#c9c9c9"), $(this).css("color", "#db3636"), str = "", $(".pplcount .cntparnt").length ? $(".pplcount .cntparnt").html("Взр.: " + cnt) : (fa = $('.childs[style*="rgb(219, 54, 54)"]'), cntt = fa.data("count"), void 0 !== cntt && (str = '<span class="cntchld">Дет.: ' + cntt + "</span> "), $(".pplcount").html('<span class="cntparnt">Взр.: ' + cnt + "</span> " + str + '<i class="fa fa-sort-down"></i>'))
			}), $(document).on("click", ".pplcount ", function(t) {
				$(".pplpopup").show()
			}), $(document).on("click", ".pplchoise", function(t) {
				$(".pplpopup").hide()
			}), hblkhvr(), 





			$(document).on("click", "#cityx a", function(t) {
				t.preventDefault(), $(".cityAll").css("display", "none"), $(".cityAll a").removeClass("active"), tx = $(this).text(), $(".citys span").text(tx), $(this).addClass("active")
			}), $(document).on("mouseover", ".work-usr", function() {
				$(this).find(".work-overload").show()
			}), $(document).on("mouseleave", ".work-usr", function() {
				$(this).find(".work-overload").hide()
			}), $(document).on("mouseover", ".pictur", function() {
				$(this).find(".hideover").show()
			}), $(document).on("mouseleave", ".pictur", function() {
				$(this).find(".hideover").hide()
			}), $(document).on("mouseover", ".awards .pic", function() {
				$(this).find(".over").show()
			}), $(document).on("mouseleave", ".awards .pic", function() {
				$(this).find(".over").hide()
			}), $(document).on("click", ".mob-close", function(t) {
				t.preventDefault(), $(".adressAll").hide()
			}), $(document).on("click", "#cityx2 a", function(t) {
				t.preventDefault(), $(".cityAll2").css("display", "none"), $(".cityAll2 a").removeClass("active"), tx = $(this).text(), $(".mobile-city span").text(tx), $(this).addClass("active")
			}), $(document).on("click", ".payoffice", function(t) {
				t.preventDefault(), $("#order").modal("show")

				$('#order input[name="form_hidden_75"]').val($(this).closest('.links').data('tourvid'))
			}), $(document).on("click", ".payonline", function(t) {
				t.preventDefault(), $("#buyme").modal("show")
			}), 
			$(document).on("click", "form#payOnline input[type=submit]", function(t) {
				t.preventDefault();
				if($("input[name=OrderId]").val()==''){
					$("#answer .modal-content").html("Выберите % оплаты"), $("#answer").modal("show")
				}
				else {
					$("form#payOnline").submit();
				}
			}),
			$(document).on("click", ".hotcity li a", function(t) {
				t.preventDefault(), txt = $(this).text(), $(this).closest(".dropdown").find(".city-toggler").html(txt + '<b class="caret"></b>'), $.get("/ajax/hotcity.php", {
					city: txt
				}, function(t) {
					var e = "";
					$.each(t, function(t, a) {
						e += '<div class="item " ><div class="hotblocks" style="background-image: url(' + a.pic + ') !important;"  data-turid="' + a.id + '"><div class="row"><div class="col-md-6 col-sm-6 col-xs-6"><span class="tur_country">' + a.country + '</span><span class="tur_city">' + a.curort + '</span></div><div class="col-md-6 col-sm-6 col-xs-6"><span class="tur_discount"> </span></div></div><div class="row"><div class="col-md-12 col-sm-12 col-xs-12"><span class="tur_price">' + a.price + ' Р</span><span class="tur_date"><i class="fa fa-plane redish"></i> Дата вылета: ' + a.dayfrom + '</span><span class="tur_night"><i class="calendar1"></i> Количество ночей: ' + a.daycnt + '</span><span class="tur_update"><i class="fa fa-refresh redish"></i> Обновлено: ' + a.modify + '</span></div></div></div><div class="hotdeals"><div><span>xxxx</span><span>xx дней</span><span>xxxxxx Р</span></div></div></div>'
					}), $(".gridview").length && ($(".gridview").trigger("replace.owl.carousel", e), $(".gridview").trigger("refresh.owl.carousel"))
				}, "json")
			}), $(document).on("click", ".chkcur li label", function(t) {
				t.preventDefault(), ob = $(this).find("span"), ob.hasClass("checkme") ? (ob.removeClass("checkme"), ob.addClass("checkeds"), ob.html('<i class="fa fa-check "></i>'), $(this).find("input").attr("checked", !0)) : (ob.removeClass("checkeds"), ob.addClass("checkme"), ob.html(""), $(this).find("input").attr("checked", !1)), $(this).hasClass("regionskurort") && hotelsReload()
			}), $(document).on("click", ".chkcur li", function(t) {
				ob = $(this).find("span"), ob.hasClass("checkme") ? (ob.removeClass("checkme"), ob.addClass("checkeds"), ob.html('<i class="fa fa-check "></i>'), $(this).find("input").attr("checked", !0)) : (ob.removeClass("checkeds"), ob.addClass("checkme"), ob.html(""), $(this).find("input").attr("checked", !1)), $(this).hasClass("regionskurort") && hotelsReload()
			}), $(document).on("click", ".pricebox span", function(t) {
				$(".pricebox span").removeClass("sel"), ob = $(this), ob.hasClass("sel") || ob.addClass("sel");
				var e = $(".pricebox .sel").text();
				if ("руб" == e) {
					var a = $("#slider-range").slider("option", "max");
					$("#slider-range").slider("option", "max", 10 * a);
					var o = $("#slider-range").slider("option", "min");
					$("#slider-range").slider("option", "min", 10 * o);
					var n = $("#slider-range").slider("option", "step");
					$("#slider-range").slider("option", "step", 10 * n), $("input[name=curency]").val("0")
				} else {
					var a = $("#slider-range").slider("option", "max");
					$("#slider-range").slider("option", "max", a / 10);
					var o = $("#slider-range").slider("option", "min");
					$("#slider-range").slider("option", "min", o / 10);
					var n = $("#slider-range").slider("option", "step");
					$("#slider-range").slider("option", "step", n / 10), $("input[name=curency]").val("1")
				}
				$("#amount").val($("#slider-range").slider("values", 0) + " " + e + " - " + $("#slider-range").slider("values", 1) + " " + e)
			}), $(document).on("click", ".hotelmenu.about", function(t) {
				t.preventDefault(), $(".xline").hide(), $(this).closest(".hotelline").find(".box-prices").show(), $(this).closest(".hotelline").find(".line-about").show()
			}), $(document).on("click", ".hotelmenu.map", function(t) {
				t.preventDefault(), $(".xline").hide(), $(this).closest(".hotelline").find(".box-prices").show(), $(this).closest(".hotelline").find(".line-map").show()
			}), $(document).on("click", ".hotelmenu.coments", function(t) {
				t.preventDefault(), $(".xline").hide(), $(this).closest(".hotelline").find(".box-prices").show(), $(this).closest(".hotelline").find(".line-coments").show()
			}), $(document).on("click", ".hotelmenu.prices", function(t) {
				t.preventDefault(), $(".xline").hide(), $(this).closest(".hotelline").find(".box-prices").show(), $(this).closest(".hotelline").find(".line-prices").show()
			}), $(document).on("click", ".getme.prices", function(t) {

				t.preventDefault()
				if($(this).hasClass('online')) {
					$(this).closest(".hotelline").find(".line-prices").find('.tr-tour').removeClass('offline')
					$(this).closest(".hotelline").find(".line-prices").find('.tr-tour').addClass('online')
				}
				else if($(this).hasClass('offline')) {
					$(this).closest(".hotelline").find(".line-prices").find('.tr-tour').removeClass('online')
					$(this).closest(".hotelline").find(".line-prices").find('.tr-tour').addClass('offline')
				}
				$(".getme.prices").removeClass('active')
				$(this).addClass('active')
				$(".xline").hide(), $(this).closest(".hotelline").find(".box-prices").show(), $(this).closest(".hotelline").find(".line-prices").show()
			}), $(document).on("click", ".footlinez .clo", function(t) {
				t.preventDefault(), $(".xline").hide(), $(this).closest(".hotelline").find(".box-prices").hide()
			}), $(document).on("click", ".question-box li a", function(t) {
				t.preventDefault(), id = $(this).data("id"), $("#results").html("<img src='/bitrix/templates/tour/images/89.gif' />"), $.get("/ajax/faq.php", {
					id: id
				}, function(t) {
					$("#results").html(t)
				})
			}), $(document).on("click", ".table .copy", function(t) {
				t.preventDefault();
				var e = $(this).data("id");
				ob = $(this).closest("tr"), $.get("/ajax/turs.php", {
					id: e,
					action: "copy"
				}, function(t) {
					"" != t && (txt = ob.html(), txt = txt.replace(e, t), ob.after("<tr>" + txt + "</tr>"))
				})
			}), $(document).on("click", ".table .delete", function(t) {
				t.preventDefault();
				var e = $(this).data("id");
				ob = $(this).closest("tr"), $.get("/ajax/turs.php", {
					id: e,
					action: "delete"
				}, function(t) {
					"" == t ? ob.remove() : alert(t)
				})
			}), $(document).on("click", ".table .edit", function(t) {
				t.preventDefault();
				var e = $(this).data("id");
				window.location.href = "?ID=" + e
			}), $(document).on("click", ".hotBaseAndDate .copy", function(t) {
				t.preventDefault();
				var e = parseFloat($(this).closest(".hotBaseAndDate").data("rid"));
				rid = e + 1, $("select").styler("destroy");
				var a = $(this).closest(".hotBaseAndDate").clone().appendTo(".appendtome");
				$(this).closest(".hotBaseAndDate").next().find(".copyme").each(function(t) {
					txt = $(this).attr("name"), txt = txt.replace(/dates\[([0-9]*)\]/g, replacer), $(this).attr("name", txt)
				}), $(this).closest(".hotBaseAndDate").next().find("h4 b").html(rid), initDropdown(), $(".dtp2").datetimepicker({
					locale: "ru",
					format: "DD.MM.YYYY LT",
					allowInputToggle: !0
				}).on("dp.hide", function(t) {
					a = $(this).closest(".hotBaseAndDate").find(".dataDeparture"), a.html($(this).val())
				}), acompl()
			}), $(document).on("click", ".hotBaseAndDate .delete", function(t) {
				t.preventDefault();
				var e = $(this).closest(".hotBaseAndDate"),
				a = e.data("rid");
				$.get("/ajax/hotbase.php", {
					id: a,
					action: "delete"
				}, function(t) {
					"" == t ? e.remove() : alert(t)
				})
			}), $(document).on("click", ".hotBaseAndDate .edit", function(t) {
				t.preventDefault(), $(".hotelbasehide").hide();
				var e = $(this).closest(".hotBaseAndDate").find(".hotelbasehide");
				e.show()
			}), $(document).on("click", ".remrow", function(t) {
				$(this).closest(".form-group").remove()
			}), $(document).on("click", ".addrow", function(t) {
				t.preventDefault(), $("select").styler("destroy"), atrn = $(this).prev().attr("name"), atrnid = $(this).prev().prev().attr("name"), $(this).html("X"), $(this).removeClass("addrow"), $(this).addClass("remrow"), html = $(this).prev().html(), $(this).closest(".form-group").after('<div class="form-group "><div class="input-group "><input type="hidden" name="' + atrnid + '" class="copyme" /><select name="' + atrn + '"  class="copyme form-control" >' + html + '</select><div class="input-group-addon addrow">+</div></div></div>'), initDropdown()
			}), $(document).on("click", ".hotBaseAndDate .dropdown .add-row", function(t) {
				t.preventDefault(), $("select").styler("destroy"), ob = $(this).closest(".row"), then = $(this).data("then"), xhtml = ob.html(), k = $(".p-p").length + 1, xhtml = xhtml.replace(/value=\"(.+?)\"/g, 'value=""'), xhtml = xhtml.replace(/[^dates]\[([0-9]*)\]/g, "][" + (k - 1) + "]"), xhtml = xhtml.replace(/<div class="p-p">([0-9]+)<\/div>/, '<div class="p-p">' + k + "</div>"), "after" == then ? ob.after('<div class="row">' + xhtml + "</div>") : ob.before('<div class="row">' + xhtml + "</div>"), initDropdown(), acompl(), changesort()
			}), $(document).on("click", ".table-promo .dropdown .add-row", function(t) {
				t.preventDefault(), $("select").styler("destroy"), ob = $(this).closest(".tr"), then = $(this).data("then"), xhtml = ob.html(), xhtml = xhtml.replace(/promo\[([0-9]+)\]/g, replacers), "after" == then ? ob.after('<div class="tr">' + xhtml + "</div>") : ob.before('<div class="tr">' + xhtml + "</div>"), initDropdown()
			}), $(document).on("click", ".hotBaseAndDate .dropdown .del-row", function(t) {
				t.preventDefault(), ob = $(this).closest(".row").remove()
			}), $(document).on("click", ".hotBaseAndDate .dropdown .up-row", function(t) {
				t.preventDefault(), ob = $(this).closest(".row"), html = ob.html(), prevrow = ob.prev(), prevrowhtml = prevrow.html(), prevrow.html(html), ob.html(prevrowhtml), changesort(), refresher()
			}), $(document).on("click", ".hotBaseAndDate .dropdown .down-row", function(t) {
				t.preventDefault(), ob = $(this).closest(".row"), html = ob.html(), prevrow = ob.next(), prevrowhtml = prevrow.html(), prevrow.html(html), ob.html(prevrowhtml), changesort(), refresher()
			}), $(document).on("click", ".table-promo .dropdown .del-row", function(t) {
				t.preventDefault(), ob = $(this).closest(".tr").remove(), id = $(this).closest(".tr").data("rowid"), void 0 !== id && $.get("/ajax/discounts.php", {
					id: id,
					action: "delete"
				}, function(t) {
					"" == t ? ob.remove() : alert(t)
				})
			}), $(document).on("click", ".departure-add", function(t) {
				t.preventDefault(), $("select").styler("destroy"), ob = $(this).closest(".hotBaseAndDate"), id = parseFloat(ob.data("rid")), htmldom = ob.html(), htmldom = htmldom.replace(/dates\[[0-9+]\]/g, replacer), id++, ob.after('<div class="hotBaseAndDate" data-rid="' + id + '">' + htmldom + "</div>"), $(".dtp2").datetimepicker({
					locale: "ru",
					format: "DD.MM.YYYY LT",
					allowInputToggle: !0
				}).on("dp.hide", function(t) {
					ob = $(this).closest(".hotBaseAndDate").find(".dataDeparture"), ob.html($(this).val())
				}), initDropdown()
			}), $(document).on("click", ".mini img", function(t) {
				picz = $(this).attr("src"), ob = $(this).closest(".col-md-6").find(".showlarge img"), ob.attr("src", picz)
			}), 









			$("#tourvisor").submit(function(t) {
				t.preventDefault(), $.get("/ajax/search.php", $("#tourvisor").serialize(), function(t) {
					//alert()
					if(t.error){
						$("#answer .modal-content").html("Укажите дату вылета") 
						$("#answer").modal("show")
					}
					else{
						console.log(t.result)
						if(t.result){
							$(".search .founded").html("<div style='text-align:center;'><img src='/bitrix/templates/tour/images/89.gif' /></div>") 

							checkState(t.result.requestid, 1) 

							$('.hotels-found-are-there').show()
						}
						else 
						{
							$("#answer .modal-content").html('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>Ошибка приложения</h1><p>' + t + "</p></div>") 
							$("#answer").modal("show")
						}
					}
				}, "json")
			}), 









			$(document).on("click", ".getonliner", function(t) {
				$(".buythistour").show(), $(".ordthistour").hide()
			}), $(document).on("click", ".getofficer", function(t) {
				$(".buythistour").hide(), $(".ordthistour").show()
			}), $(document).on("click", ".ordthistour", function(t) {


				$("#orderfor").find('input[name="form_hidden_75"]').val($(this).data('tourid'))
				$("#orderfor").modal("show")
			}), $(document).on("click", ".add-comment", function(t) {
				$(this).prev().show(), $(this).text("Сохранить"), $(this).removeClass("add-comment"), $(this).addClass("save-comment link")
			}), 



















			$(document).on("click", ".edit-comment", function(t) {
				txt = $(this).prev().text(), $(this).prev().html('<div class="form-group "><textarea style="display: block;" class="form-control">' + txt + "</textarea></div>"), $(this).removeClass("edit-comment"), $(this).addClass("save-comment"), $(this).text("Сохранить")
			}), 


			$(document).on("change", 'input[name="sortindex"]', function(t) {
				t.preventDefault();
				var e = $(this).data("id"),
				a = $(this).val();
				$.get("/ajax/turs.php", {
					id: e,
					action: "sort",
					sort: a
				}, function(t) {
					"" !== t && alert(t)
				})
			}), 









			$(document).on("click", ".line-coments a.more", function(t) {
				t.preventDefault(), $(".line-coments p").css("height", "33px"), $(this).prev().css("height", "auto")
			}), $(document).on("click", ".hotelmenu.about", function(t) {
				ob = $(this).closest(".hotelline"), id = ob.data("hotelid"), $.get("/ajax/getinfo.php", {
					id: id,
					a: "about"
				}, function(t) {
					ob.find(".line-about").html(t)
				})
			}), $(document).on("click", ".hotelmenu.map", function(t) {
				ob = $(this).closest(".hotelline"), id = ob.data("hotelid"), $.get("/ajax/getinfo.php", {
					id: id,
					a: "map"
				}, function(t) {
					ob.find(".line-map").html(t)
				})
			}), $(document).on("click", ".hotelmenu.coments", function(t) {
				ob = $(this).closest(".hotelline"), id = ob.data("hotelid"), $.get("/ajax/getinfo.php", {
					id: id,
					a: "rew"
				}, function(t) {
					ob.find(".line-coments").html(t)
				})
			}), $(document).on("click", ".srchpls button", function(t) {
				t.preventDefault(), void 0 !== $(this).data("cid") && (window.location.href = "/catalog/country/" + $(this).data("cid")), void 0 !== $(this).data("hid") && (window.location.href = "/catalog/hotel/" + $(this).data("hid"))
			}), $(document).on("click", ".ddwn2 p", function(t) {
				id = $(this).data("cid"), txt = $(this).text(), $("input[name=hotelname]").val(txt), $(this).closest(".srchpls").find("button").data("hid", id), $(".ddwn2").hide()
			}), 





			$(document).on("click", ".ddwn p", function(t) {

				id = $(this).data("cid"), txt = $(this).text(), 
				$("input[name=countryname]").val(txt), 
				$(".ddwn").hide(), 
				$(this).closest(".srchpls").find("button").data("cid", id), 

				$.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=hotel&hotcountry=" + id + "&callback=?", function(t) {
					var e = "";
					if (t.lists.hotels.hotel.length > 0)
						for (var a = 0; a < t.lists.hotels.hotel.length; a++) e = e + "<p data-cid='" + t.lists.hotels.hotel[a].id + "'>" + t.lists.hotels.hotel[a].name + "</p>";
							$(".ddwn2").html(e), "" == e ? $(".ddwn2").hide() : $(".ddwn2").show(), $('input[name="hotelname"]').attr("disabled", !1)
					})
			}), 





			$(document).on("change", ".hotelzname", function(t) {
				div = $(this).closest(".col-md-3").find(".urladr"), "" == $(this).prev().val() && 0 == div.length && (n = $(this).attr("name"), n = n.replace("name", "urladr"), $(this).after('<div class="form-group urladr"><label for=" ">УРЛ отеля</label><input name="' + n + '" value="" placeholder="http:// отеля" class="form-control"></div>'))
			}),






			$(document).on("keyup", ".srchpls input[name=countryname]", function(t) {
				var e = $(this).val();
				e.length && $.getJSON("http://tourvisor.ru/xml/list.php?format=json&type=country&callback=?", function(t) {
					for (var a = "", o = 0, n = 0; n < t.lists.countries.country.length; n++) {
						str = t.lists.countries.country[n].name;
						var i = str.indexOf(e, o);
						0 == i && (a = a + "<p data-cid='" + t.lists.countries.country[n].id + "'>" + t.lists.countries.country[n].name + "</p>")
					}
					$(".ddwn").html(a), "" == a ? $(".ddwn").hide() : $(".ddwn").show()
				})
			}),






			$(document).on("click", ".showlarge img", function(t) {
				pic = $(this).attr("src"), $("#largepic .modal-content").html("<img src='" + pic + "' width=100%>")
			}), $(document).on("click", ".navbar .adressAll li a", function(t) {
				id = $(this).data("mapid"), $.get("/ajax/map.php", {
					id: id
				}, function(t) {
					$("#showmap .modal-content").html(t)
				})
			}), $(document).on("keydown", "input.dopsz", function(t) {
				incudez($(this))
			}), $(function() {
				acompl(), $('input[name="REGISTER[PERSONAL_CITY]"]').length && $('input[name="REGISTER[PERSONAL_CITY]"]').val(userCity), $grid = $(".grid").masonry({
					itemSelector: ".grid-item",
					columnWidth: ".col-md-3",
					percentPosition: !0
				}), $("#myTown").length /*&& $("#myTown").modal("show")*/, $(".search .results").length && checkState(reqID);
				var t = $(".pricebox .sel").text();
				$("#slider-range").slider({
					range: !0,
					min: 1e4,
					max: 9e5,
					step: 1e4,
					values: [0, 5e5],
					slide: function(t, e) {
						var a = $(".pricebox .sel").text();
						$("#amount").val(e.values[0] + " " + a + " - " + e.values[1] + " " + a)
					}
				}), $("#amount").val($("#slider-range").slider("values", 0) + " " + t + " - " + $("#slider-range").slider("values", 1) + " " + t), 


				$(window).scroll(function() {
					if($(this).scrollTop() > 0 && $(window).width() > 1000 && get_name_browser() != 'IE')  {
						$("#scroller").fadeIn()  

					}
					else {
						$("#scroller").fadeOut()
					}
				}),
				$("#scroller").click(function() {
					$(this).addClass('hiddenscroller')
					$(this).fadeOut()
					if(get_name_browser() != 'IE') {

						$("body,html").animate({
							scrollTop: 0
						}, 400), 
						$.fn.fullpage.moveTo(1), !1

					}
					else {

						$(".iecontainer").animate({
							scrollTop: 0
						}, 400)
					}
				}), 

				$(".mapover").show(), getCityByIp(officeForCity), 

				$("input[name=daterangefly]").daterangepicker({
					"dateLimit": {
						"days": 14
					},
					locale: {
						format: "DD.MM",
						separator: " - ",
						applyLabel: "Выбрать",
						cancelLabel: "Отмена",
						fromLabel: "от",
						toLabel: "до",
						customRangeLabel: "Custom",
						weekLabel: "W",
						daysOfWeek: ["Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб"],
						monthNames: ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"],
						firstDay: 1
					}
				}), $(".dtp1").datetimepicker({
					locale: "ru",
					format: "DD.MM",
					allowInputToggle: !0
				}).on("dp.hide", function(t) {
					ob = $(this).closest(".hotBaseAndDate").find(".dataDeparture"), ob.html($(this).val())
				}), 



				$(".dtp3").datetimepicker({
					locale: "ru",
					format: "DD.MM.YYYY",
					allowInputToggle: !0
				}),



				$(".dtp2").datetimepicker({
					locale: "ru",
					format: "DD.MM.YYYY LT",
					allowInputToggle: !0
				}).on("dp.hide", function(t) {
					ob = $(this).closest(".hotBaseAndDate").find(".dataDeparture"), ob.html($(this).val())
				}), $(".city-toggler").dropdown() 

					// $(".hot-carusel2").owlCarousel({
					// 	loop: !1,
					// 	margin: 10,
					// 	dots: !1,
					// 	items: 4,
					// 	nav: !0
					// }),
					if($(window).width() > 1000 || $(window).width() < 620) {

						$(".reviewes").owlCarousel({
							loop: !1,
							margin: 30,
							dots: !1,
							nav: !0,
							responsive: {
								0: {
									items: 1
								},
								600: {
									items: 1
								},
								768: {
									items: 2
								},
								1e3: {
									items: 1
								}
							}
						})
					}



					$(".lastart-carousel").owlCarousel({
						loop: !1,
						margin: 25,
						dots: !1,
						nav: !0,
						responsive: {
							0: {
								items: 1
							},
							600: {
								items: 1
							},
							768: {
								items: 2
							},
							1e3: {
								items: 3
							}
						}
					}), $(".peopl-carusel").length && $(".peopl-carusel").owlCarousel({
						loop: !1,
						margin: 20,
						dots: !1,
						nav: !0,
						responsive: {
							0: {
								items: 2
							},
							600: {
								items: 1
							},
							1e3: {
								items: 4
							}
						}
					}), $(".nagrada-carousel").length && $(".nagrada-carousel").owlCarousel({
						loop: !1,
						margin: 0,
						dots: !1,
						nav: !0,
						items: 1
					}), $(".boss-carousel").length && $(".boss-carousel").owlCarousel({
						loop: !1,
						margin: 0,
						dots: !1,
						nav: !0,
						items: 1
					}), $(".country-carousel").length && $(".country-carousel").owlCarousel({
						loop: !1,
						margin: 0,
						dots: !1,
						nav: !0,
						items: 1
					}), $(window).width() < 1e3 ? ($("#buyonline .modal-dialog").removeClass("modal-lg"), $(".magic").addClass("col-xs-12"), $(".preim-carousel").addClass("owl-carousel"), $(".preim-carousel").owlCarousel({
						loop: !1,
						margin: 0,
						dots: !1,
						nav: !0,
						center: !0,
						responsive: {
							0: {
								items: 1
							}
						}
					}), $(".award-carousel").addClass("owl-carousel"), $(".award-carousel").owlCarousel({
						loop: !1,
						margin: 0,
						dots: !1,
						nav: !0,
						center: !0,
						responsive: {
							0: {
								items: 1
							}
						}
					}), $(".work-box").addClass("owl-carousel"), $(".work-box").owlCarousel({
						loop: !1,
						margin: 0,
						dots: !1,
						nav: !0,
						center: !0,
						responsive: {
							0: {
								items: 1
							}
						}
					}), $(".franchise-carusel").owlCarousel({
						loop: !1,
						margin: 10,
						dots: !1,
						items: 1,
						nav: !0
					}), $(".teach-carusel").owlCarousel({
						loop: !1,
						margin: 10,
						dots: !1,
						items: 1,
						nav: !0
					}), $("#listcity").length && $("#listcity").liColl({
						c_unit: "px",
						n_coll: 2,
						c_width: 150,
						p_left: 15
					})) : ( $("#cityx").liColl({
						c_unit: "px",
						n_coll: 4,
						c_width: 190,
						p_left: 10
					}), $("#listcity").length && $("#listcity").liColl({
						c_unit: "px",
						n_coll: 4,
						c_width: 280,
						p_left: 30
					})), $(document).on("click", ".fly_date", function(t) {
						$(".fly_date").removeClass("checked"), $(this).addClass("checked")
					}), $(document).on("click", ".hotlist", function(t) {
						$(".hotthumb").removeClass("active"), $(this).addClass("active"), $(".hotel-list").show(), $(".hotel-carusel").hide(), $(".listview").show(), $(".gridview").hide(), $(".listviewz").show(), $(".gridviewz").hide()
					}), $(document).on("click", ".slideMenu", function(t) {
						0 == $(".botSlideMenu").length ? ($(".footer").addClass("botSlideMenu"), $(".slideMenu").addClass("active"), $(".slideMenu").addClass("fa-angle-down"), $(".slideMenu").removeClass("fa-angle-up"), $(".tds.subscribe").show(), $(".tds.social").show(), $(".footer_link a:last-child").show(), $(".footer_link a").wrap("<p></p>")) : ($(".footer_link a").unwrap(), $(".footer").removeClass("botSlideMenu"), $(".slideMenu").addClass("fa-angle-up"), $(".slideMenu").removeClass("fa-angle-down"), $(".slideMenu").removeClass("active"), $(".tds.subscribe").hide(), $(".tds.social").hide(), $(".footer_link a:last-child").hide())
					}), $(document).on("click", ".hotthumb", function(t) {
						$(".hotlist").removeClass("active"), $(this).addClass("active"), $(".gridview").show(), $(".listview").hide(), $(".gridviewz").show(), $(".listviewz").hide(), $(".hotel-carusel").show(), $(".hotel-list").hide()
					}), $(document).on("click", ".mobile-city", function(t) {
						$(".cityAll2").show(), $(".navigation").hide()
					}), $(document).on("click", ".addsoc", function(t) {
						$(this).before('<div class="form-group "><input name="link[]" class="form-control" placeholder="Ссылка на социальную сеть"></div>')
					}), 


					$(document).on("submit", "#comp-srch", function(t) {
						t.preventDefault(), $("#results").html("<img src='/bitrix/templates/tour/images/89.gif' />"), $.post("/ajax/companion.php", $("#comp-srch").serialize(), function(t) {
							$("#results").html(t)
							setTimeout(function(){
								$(window).scroll(function(){
									var boxesinwindow = inWindow('.find-box')
								//console.log(boxesinwindow)
								boxesinwindow.each(function(){
									var id = $(this).data('id')
									addViewCountForCompanion(id)
								})
							})
							}, 2000)
						})
					}), 


					$(document).on("click", ".bigbtn.ank", function(t) {
						var e = new FormData($("form#anketaComp")[0]);
						$.ajax({
							type: "POST",
							url: "/ajax/addcompanion.php",
							data: e,
							contentType: !1,
							processData: !1,
							success: function(t) {
								"ok" == t ? ($("#addcompany").modal("hide"), $("#anketaComp")[0].reset(), $("#answer .modal-content").html('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4></div><div class="thnx"><h1>Спасибо, ваша заявка принята!</h1><p>Еще текст сообщения</p></div>')) : $("#answer .modal-content").html(t), Recaptchafree.reset(), $("#answer").modal("show")
							}
						})
					}), 

					$(document).on("click", ".more-companion", function(t) {
						$("#fullview .modal-content").html(""), $("#fullview .modal-content").html($(this).closest(".col-md-4").html()), $("#fullview").modal("show")
					}), $(document).on("click", ".otklikjob", function(t) {
						t.preventDefault(), id = $(this).data("id"), $("input.vakancy").val(id), $("#jobform").modal("show")
					}), $(document).on("click", ".job-box .more", function(t) {

						t.preventDefault()
						var addition = '<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div>'
						id = $(this).data("id"), $("#jobinfo a").data("id", id), html = $(this).closest(".job-box").find(".job-full-text").html(), $("#jobinfo .jobinfo").html(addition+html), $("#jobinfo").modal("show")
					}), $(document).on("click", ".starq label", function(t) {
						t.preventDefault(), $(this).prev().prop("checked", !0)
					}), $(document).on("click", ".bottominf span", function(t) {
						t.preventDefault(), $(".fulltable").hide()
					}),
					$(document).on("click", ".box-price-check a", function(t) {
						t.preventDefault(), $(".box-price-check div:first-child").html('<img src="/bitrix/templates/tour/images/89.gif" />'), setTimeout(function() {
							checkPrice($(".box-price-check a"))
						}, 5e3), $(".saveorderform").addClass("checkex")
					})
				}), $(window).scroll(function() {
					$(window).scrollTop() + $(window).height() >= $(document).height() - 200 && !inProgress && ($(".search .founded").length && parseFloat($(".statuse .all").text()) > $(".hotelline").length && (sPage++, checkState($(".search .founded .statuse").data("search"), sPage)), $(".grid-sizer").length && ($('.grid-item[style*="none"]').each(function(t) {
						4 > t && $(this).show()
					}), $grid.masonry("layout")))
				}), $(window).resize(function() {
						// $("#fullPage").length && $.fn.fullpage.reBuild()
					}),  $(".catalogcountry").length && catalCountry(), transliterate = function() {
					var t = "щ   ш  ч  ц  ю  я  ё  ж  ъ  ы  э  а б в г д е з и й к л м н о п р с т у ф х ь".split(/ +/g),
					e = "shh sh ch cz yu ya yo j `` y e a b v g d e z i j k l m n o p r s t u f h i".split(/ +/g);
					return function(a, o) {
						var n;
						for (n = 0; n < t.length; n++) a = a.split(o ? e[n] : t[n]).join(o ? t[n] : e[n]), a = a.split(o ? e[n].toUpperCase() : t[n].toUpperCase()).join(o ? t[n].toUpperCase() : e[n].toUpperCase());
							return a
					}

				}();


$(document).on('click', '#reload_lkorders', function(e){
	e.preventDefault();
	var location = window.location.href;
	if(location.search('reload=orders') != -1) window.location.href = location;
	else window.location.href = location+'?reload=orders';
})

$(document).on('ready', function(){
	var location = window.location.href;
	if(location.search('reload=orders') != -1) {
		$('.nav-tabs a[href="#home"]').tab('show');
		$('.nav-tabs a[href="#orders"]').tab('show');
	}
})